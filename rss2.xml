<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Victor</title>
    <link>https://ckck803.github.io/</link>
    
    <atom:link href="https://ckck803.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>개발 노트</description>
    <pubDate>Mon, 26 Feb 2024 16:18:40 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>Spring - 의존성 주입 방식</title>
      <link>https://ckck803.github.io/2024/02/27/spring/spring-core/spring-dependency-injection/</link>
      <guid>https://ckck803.github.io/2024/02/27/spring/spring-core/spring-dependency-injection/</guid>
      <pubDate>Mon, 26 Feb 2024 15:14:19 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/springboot/Spring-Core/spirng-core.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;IoC-Inversion-of-Control-컨테이너&quot;&gt;&lt;a href=&quot;#IoC-Inversion-of-Control-</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/springboot/Spring-Core/spirng-core.png"></p><h1 id="IoC-Inversion-of-Control-컨테이너"><a href="#IoC-Inversion-of-Control-컨테이너" class="headerlink" title="IoC(Inversion of Control) 컨테이너"></a>IoC(Inversion of Control) 컨테이너</h1><p>Ioc(Inversion of Control) 한국말로는 제어의 역전이다. 여기서 말하는 제어는 무엇일까?<br>일단 제어의 의미부터 알아보면! <em><strong>프로그램의 흐름</strong></em>, <em><strong>객체의 생성</strong></em>, <em><strong>객체간의 의존성</strong></em> 등을 의미하는데 이런 것들은 보통 프로그래머들이 관리를 하던 요소들이다. 그런데 <strong>IoC 컨테이너</strong>의 등장으로 이런 것들을 프로그래머가 직접 관리하는 것들을 컨테이너가 대신 해주게 됐다. 이것을 보고 우리는 <code>IoC(제어의 역전)</code> 이라한다.</p><blockquote><p>스프링은 <code>ApplicationContext</code> or <code>BeanFactory</code>라는 IOC 컨테이너 인터페이스를 제공한다. IOC 컨테이너를 직접 쓸 일이 거의 없다.</p></blockquote><h2 id="코드를-통해-알아보기"><a href="#코드를-통해-알아보기" class="headerlink" title="코드를 통해 알아보기"></a>코드를 통해 알아보기</h2><p><strong>생성자를 통한 의존성 주입</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OwnerController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> OwnerRepository repo;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OwnerController</span><span class="params">(OwnerRepository repo)</span> &#123; </span><br><span class="line">        <span class="built_in">this</span>.repo = repo;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// repo를 사용합니다. </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IOC컨테이너는 위의 코드를 동작하게 만들어준다.<br>위 코드를 보면 OwnerController는 OwnerRepository 객체를 사용한다. 이것을 OwnerController클래스는 OwnerRepository클래스에 의존한다.라고 말한다.</p><p>여기서의 관권은 누가 OwnerRepository를 만드냐? 관리하냐?이다. 바로 <strong>IoC 컨테이너</strong> 가 OwnerRepository 객체를 생성하고 주입해준다. OwnerController가 IOC컨테이너 내부에 객체로 들어오게 되고 IOC컨테이너 내부에서 OwnerController의 객체를 만들어준다. OwnerRepository 타입의 객체도 만들어준다.</p><p>IOC컨테이너는 이런 <code>Bean</code>들의 의존성을 관리해준다.</p><blockquote><p>Bean : 컨테이너 내부에 만든 객체들</p></blockquote><h2 id="의존성-주입"><a href="#의존성-주입" class="headerlink" title="의존성 주입"></a>의존성 주입</h2><p><code>@Autowired</code>와 <code>@Inject</code>를 이용해서 의존성을 주입해준다.</p><p>@Autowired가 없더라도, Bean에 생성자가 하나만 있고 그 생성자의 parameter로 받는 타입의 Bean이 존재한다면 해당 Bean(parameter)은 주입을 해준다. </p><h3 id="Autowired와-Inject를-붙일-수-있는-위치"><a href="#Autowired와-Inject를-붙일-수-있는-위치" class="headerlink" title="@Autowired와 @Inject를 붙일 수 있는 위치"></a>@Autowired와 @Inject를 붙일 수 있는 위치</h3><ol><li>생성자</li><li>필드</li><li>Setter</li></ol>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring/">Spring</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Framework/">Spring Framework</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Framework/Spring-Core/">Spring Core</category>
      
      
      
      <comments>https://ckck803.github.io/2024/02/27/spring/spring-core/spring-dependency-injection/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Vite 환경에서 tsconfig Path 사용하기</title>
      <link>https://ckck803.github.io/2024/02/24/react/vite/tsconfig-vite/</link>
      <guid>https://ckck803.github.io/2024/02/24/react/vite/tsconfig-vite/</guid>
      <pubDate>Fri, 23 Feb 2024 21:31:46 GMT</pubDate>
      
        
        
      <description>&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; react &lt;span class=&quot;keyw</description>
        
      
      
      
      <content:encoded><![CDATA[<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> react <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;defineConfig&#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">EnvironmentPlugin</span> <span class="keyword">from</span> <span class="string">&quot;vite-plugin-environment&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> tsconfigPaths <span class="keyword">from</span> <span class="string">&quot;vite-tsconfig-paths&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">react</span>(),</span><br><span class="line">    <span class="title function_">tsconfigPaths</span>(),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  build  : &#123;</span><br><span class="line">    <span class="attr">outDir</span>: <span class="string">&quot;./build&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  server : &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="title class_">Number</span>(process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  define : &#123;&#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/React/">React</category>
      
      <category domain="https://ckck803.github.io/categories/React/Vite/">Vite</category>
      
      
      
      <comments>https://ckck803.github.io/2024/02/24/react/vite/tsconfig-vite/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Vuex - Helper 함수</title>
      <link>https://ckck803.github.io/2024/02/16/vue/vuex/vuex-helper/</link>
      <guid>https://ckck803.github.io/2024/02/16/vue/vuex/vuex-helper/</guid>
      <pubDate>Fri, 16 Feb 2024 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/vue/vuex.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;mapState&quot;&gt;&lt;a href=&quot;#mapState&quot; class=&quot;headerlink&quot; title=&quot;mapState&quot;&gt;&lt;/a&gt;mapState&lt;/h2&gt;&lt;h2 id=&quot;m</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/vue/vuex.png"></p><h2 id="mapState"><a href="#mapState" class="headerlink" title="mapState"></a>mapState</h2><h2 id="mapGetters"><a href="#mapGetters" class="headerlink" title="mapGetters"></a>mapGetters</h2>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Vue/">Vue</category>
      
      <category domain="https://ckck803.github.io/categories/Vue/Vuex/">Vuex</category>
      
      
      
      <comments>https://ckck803.github.io/2024/02/16/vue/vuex/vuex-helper/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Vuex 시작하기</title>
      <link>https://ckck803.github.io/2024/02/15/vue/vuex/vuex-start/</link>
      <guid>https://ckck803.github.io/2024/02/15/vue/vuex/vuex-start/</guid>
      <pubDate>Thu, 15 Feb 2024 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/vue/vuex.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;라이브러리-등록&quot;&gt;&lt;a href=&quot;#라이브러리-등록&quot; class=&quot;headerlink&quot; title=&quot;라이브러리 등록&quot;&gt;&lt;/a&gt;라이브러리 등록&lt;/h2&gt;&lt;figure c</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/vue/vuex.png"></p><h2 id="라이브러리-등록"><a href="#라이브러리-등록" class="headerlink" title="라이브러리 등록"></a>라이브러리 등록</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Vue 3 </span></span><br><span class="line">npm install vuex --save</span><br><span class="line"><span class="comment"># Vue 2</span></span><br><span class="line">npm install vuex@3.6.2 --save</span><br></pre></td></tr></table></figure><h2 id="Store-생성"><a href="#Store-생성" class="headerlink" title="Store 생성"></a>Store 생성</h2><ul><li>Vue 2 에서 Store 생성</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Store</span> = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123; </span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>Vue 3 에서 Store 생성</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;&#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Store-등록"><a href="#Store-등록" class="headerlink" title="Store 등록"></a>Store 등록</h2><ul><li>Vue 2 에서 Store 등록</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store/store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  store,</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>Vue 3 에서 Store 등록</li></ul><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(store).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Vue/">Vue</category>
      
      <category domain="https://ckck803.github.io/categories/Vue/Vuex/">Vuex</category>
      
      
      
      <comments>https://ckck803.github.io/2024/02/15/vue/vuex/vuex-start/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Vue - 시작하기</title>
      <link>https://ckck803.github.io/2024/01/16/vue/vue/vue-start/</link>
      <guid>https://ckck803.github.io/2024/01/16/vue/vue/vue-start/</guid>
      <pubDate>Tue, 16 Jan 2024 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/vue/vue.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;라이브러리-설치&quot;&gt;&lt;a href=&quot;#라이브러리-설치&quot; class=&quot;headerlink&quot; title=&quot;라이브러리 설치&quot;&gt;&lt;/a&gt;라이브러리 설치&lt;/h2&gt;&lt;figure cl</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/vue/vue.png"></p><h2 id="라이브러리-설치"><a href="#라이브러리-설치" class="headerlink" title="라이브러리 설치"></a>라이브러리 설치</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install vue -g</span><br></pre></td></tr></table></figure><h2 id="프로젝트-생성"><a href="#프로젝트-생성" class="headerlink" title="프로젝트 생성"></a>프로젝트 생성</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vue create &lt;생성할 프로젝트 이름&gt;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Vue CLI v5.0.8</span><br><span class="line">? Please pick a preset: (Use arrow keys)</span><br><span class="line">❯ Default ([Vue 3] babel, eslint)</span><br><span class="line">  Default ([Vue 2] babel, eslint)</span><br><span class="line">  Manually <span class="keyword">select</span> features</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Vue CLI v5.0.8</span><br><span class="line">? Please pick a preset: Manually <span class="keyword">select</span> features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project: (Press &lt;space&gt; to <span class="keyword">select</span>, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection, and &lt;enter&gt; to proceed)</span><br><span class="line"> ◉ Babel</span><br><span class="line"> ◉ TypeScript</span><br><span class="line"> ◯ Progressive Web App (PWA) Support</span><br><span class="line">❯◉ Router</span><br><span class="line"> ◉ Vuex</span><br><span class="line"> ◯ CSS Pre-processors</span><br><span class="line"> ◉ Linter / Formatter</span><br><span class="line"> ◯ Unit Testing</span><br><span class="line"> ◯ E2E Testing</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Vue CLI v5.0.8</span><br><span class="line">? Please pick a preset: Manually <span class="keyword">select</span> features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project: Babel, TS, Router, Vuex, Linter</span><br><span class="line">? Choose a version of Vue.js that you want to start the project with 3.x</span><br><span class="line">? Use class-style component syntax? No</span><br><span class="line">? Use Babel alongside TypeScript (required <span class="keyword">for</span> modern mode, auto-detected polyfills, transpiling JSX)? Yes</span><br><span class="line">? Use <span class="built_in">history</span> mode <span class="keyword">for</span> router? (Requires proper server setup <span class="keyword">for</span> index fallback <span class="keyword">in</span> production) Yes</span><br><span class="line">? Pick a linter / formatter config: Prettier</span><br><span class="line">? Pick additional lint features: Lint on save</span><br><span class="line">? Where <span class="keyword">do</span> you prefer placing config <span class="keyword">for</span> Babel, ESLint, etc.? In dedicated config files</span><br><span class="line">? Save this as a preset <span class="keyword">for</span> future projects? (y/N) n</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Vue/">Vue</category>
      
      
      
      <comments>https://ckck803.github.io/2024/01/16/vue/vue/vue-start/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Security - SecurityContextRepository</title>
      <link>https://ckck803.github.io/2024/01/16/spring/spring-security/security/SecurityContextRepository/</link>
      <guid>https://ckck803.github.io/2024/01/16/spring/spring-security/security/SecurityContextRepository/</guid>
      <pubDate>Tue, 16 Jan 2024 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/springboot/security/inflearn-whiteship-security/spring-security.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;SecurityContextRepository&quot;&gt;&lt;a href=&quot;#</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/springboot/security/inflearn-whiteship-security/spring-security.png"></p><h2 id="SecurityContextRepository"><a href="#SecurityContextRepository" class="headerlink" title="SecurityContextRepository"></a>SecurityContextRepository</h2><blockquote><p>SecurityContextRepository 는 SecurityContext 를 저장하고 검색하기 위한 저장소입니다.</p></blockquote><p>Spring Security 에서는 인증 후 생성된 SecurityContext 를 저장하고 관리하기 위해 SecurityContextRepository 인터페이스를 제공합니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SecurityContextRepository</span> &#123;</span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    SecurityContext <span class="title function_">loadContext</span><span class="params">(HttpRequestResponseHolder requestResponseHolder)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> DeferredSecurityContext <span class="title function_">loadDeferredContext</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        Supplier&lt;SecurityContext&gt; supplier = () -&gt; loadContext(<span class="keyword">new</span> <span class="title class_">HttpRequestResponseHolder</span>(request, <span class="literal">null</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SupplierDeferredSecurityContext</span>(SingletonSupplier.of(supplier),</span><br><span class="line">                SecurityContextHolder.getContextHolderStrategy());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 변경된 보안 컨텍스트를 저장합니다. 주로 사용자가 인증되면 새로운 보안 컨텍스트를 저장하는 데 사용됩니다.</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveContext</span><span class="params">(SecurityContext context, HttpServletRequest request, HttpServletResponse response)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 현재 요청에서 보안 컨텍스트가 존재하는지 확인합니다.</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">containsContext</span><span class="params">(HttpServletRequest request)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Session-에-저장-HttpSessionSecurityContextRepository"><a href="#Session-에-저장-HttpSessionSecurityContextRepository" class="headerlink" title="Session 에 저장 - HttpSessionSecurityContextRepository"></a>Session 에 저장 - HttpSessionSecurityContextRepository</h4><blockquote><p>HttpSessionSecurityContextRepository 는 Session 에 SecurityContext 정보를 저장합니다.</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveContext</span><span class="params">(SecurityContext context, HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="type">SaveContextOnUpdateOrErrorResponseWrapper</span> <span class="variable">responseWrapper</span> <span class="operator">=</span> WebUtils.getNativeResponse(response,</span><br><span class="line">            SaveContextOnUpdateOrErrorResponseWrapper.class);</span><br><span class="line">    <span class="keyword">if</span> (responseWrapper == <span class="literal">null</span>) &#123;</span><br><span class="line">        saveContextInHttpSession(context, request);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    responseWrapper.saveContext(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveContextInHttpSession</span><span class="params">(SecurityContext context, HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTransient(context) || isTransient(context.getAuthentication())) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">SecurityContext</span> <span class="variable">emptyContext</span> <span class="operator">=</span> generateNewContext();</span><br><span class="line">    <span class="keyword">if</span> (emptyContext.equals(context)) &#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession(<span class="literal">false</span>);</span><br><span class="line">        removeContextFromSession(context, session);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">createSession</span> <span class="operator">=</span> <span class="built_in">this</span>.allowSessionCreation;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession(createSession);</span><br><span class="line">        setContextInSession(context, session);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Request-객체에-저장-RequestAttributeSecurityContextRepository"><a href="#Request-객체에-저장-RequestAttributeSecurityContextRepository" class="headerlink" title="Request 객체에 저장 - RequestAttributeSecurityContextRepository"></a>Request 객체에 저장 - RequestAttributeSecurityContextRepository</h4><blockquote><p>RequestAttributeSecurityContextRepository 는 Request 객체에 SecurityContext 정보를 저장하는 객체입니다. </p></blockquote><p>RequestAttributeSecurityContextRepository 는 요청 정보에 SecurityContext 를 저장하기 때문에 요청이 끝나게 되면 SecurityContext 정보도 같이 사라지게 됩니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveContext</span><span class="params">(SecurityContext context, HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    request.setAttribute(<span class="built_in">this</span>.requestAttributeName, context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="여러개의-Request-객체에-저장-DelegatingSecurityContextRepository"><a href="#여러개의-Request-객체에-저장-DelegatingSecurityContextRepository" class="headerlink" title="여러개의 Request 객체에 저장 - DelegatingSecurityContextRepository"></a>여러개의 Request 객체에 저장 - DelegatingSecurityContextRepository</h4><p>여러개의 SecurityContextRepository 를 사용하기 위해 Spring Security 에서는 DelegatingSecurityContextRepository 를 제공합니다. 다음과 같이 여러개의 SecurityContextRepository 객체를 인자로 해 DelegatingSecurityContextRepository 객체를 생성할 수 있습니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> SecurityContextRepository <span class="title function_">securityContextRepository</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DelegatingSecurityContextRepository</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">RequestAttributeSecurityContextRepository</span>(),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HttpSessionSecurityContextRepository</span>()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DelegatingSecurityContextRepository 또한 같은 SecurityContextRepository 인터페이스를 통해 생성된 구현체라 사용하는 방식의 차이는 없습니다. 다만, 내부적으로 여러개의 SecurityContextRepository 를 한번씩 실행시키는 방식으로 로직을 수행합니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SecurityContext <span class="title function_">loadContext</span><span class="params">(HttpRequestResponseHolder requestResponseHolder)</span> &#123;</span><br><span class="line">    <span class="type">SecurityContext</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (SecurityContextRepository delegate : <span class="built_in">this</span>.delegates) &#123;</span><br><span class="line">        <span class="type">SecurityContext</span> <span class="variable">delegateResult</span> <span class="operator">=</span> delegate.loadContext(requestResponseHolder);</span><br><span class="line">        <span class="keyword">if</span> (result == <span class="literal">null</span> || delegate.containsContext(requestResponseHolder.getRequest())) &#123;</span><br><span class="line">            result = delegateResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      
      <category domain="https://ckck803.github.io/tags/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/tags/Spring-Security/">Spring Security</category>
      
      
      <comments>https://ckck803.github.io/2024/01/16/spring/spring-security/security/SecurityContextRepository/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Security - SecurityContextPersistenceFilter 와 SecurityContextHolderFilter</title>
      <link>https://ckck803.github.io/2024/01/16/spring/spring-security/security/filter/SecurityContextPersistenceFilter/</link>
      <guid>https://ckck803.github.io/2024/01/16/spring/spring-security/security/filter/SecurityContextPersistenceFilter/</guid>
      <pubDate>Tue, 16 Jan 2024 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;SecurityContextPersistenceFilter&quot;&gt;&lt;a href=&quot;#SecurityContextPersistenceFilter&quot; class=&quot;headerlink&quot; title=&quot;SecurityContextPersistenceFi</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="SecurityContextPersistenceFilter"><a href="#SecurityContextPersistenceFilter" class="headerlink" title="SecurityContextPersistenceFilter"></a>SecurityContextPersistenceFilter</h2><p>SecurityContextPersistenceFilter 에서는 인증을 위해 SecurityContextRepository 에 저장된 SecurityContext 정보를 가져와 인증 처리를 하고 SecurityContext 정보를 SecurityContextRepository 에 저장합니다.</p><p><img src="/images/springboot/security/spring-security/SecurityContextPersistenceFilter.png" alt="SecurityContextPersistenceFilter 동작 과정"></p><h2 id="SecurityContextHolderFilter"><a href="#SecurityContextHolderFilter" class="headerlink" title="SecurityContextHolderFilter"></a>SecurityContextHolderFilter</h2><p>SecurityContextHolderFilter 에서는 인증을 위해 SecurityContextRepository 에 저장된 SecurityContext 정보를 가져와 인증 처리를 하지만 SecurityContextPersistenceFilter 와는 다르게 SecurityContextRepository 에 저장하지는 않습니다.</p><p><img src="/images/springboot/security/spring-security/SecurityContextHolderFilter.png" alt="SecurityContextHolderFilter 동작 과정"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring/">Spring</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Security/">Spring Security</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Security/Filter/">Filter</category>
      
      
      
      <comments>https://ckck803.github.io/2024/01/16/spring/spring-security/security/filter/SecurityContextPersistenceFilter/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Django - App 생성하기</title>
      <link>https://ckck803.github.io/2023/12/09/django/django/create_app/</link>
      <guid>https://ckck803.github.io/2023/12/09/django/django/create_app/</guid>
      <pubDate>Sat, 09 Dec 2023 11:47:30 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/django/django.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/12/0</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/django/django.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/12/09/django/django/create_app/" title="Django - App 생성하기">Django - App 생성하기</a></li><li><a href="/2023/12/09/django/django/start_django/" title="Django - 장고 시작하기">Django - 장고 시작하기</a></li></ul><h2 id="장고-앱-만들기"><a href="#장고-앱-만들기" class="headerlink" title="장고 앱 만들기"></a>장고 앱 만들기</h2><p>장고 App 생성은 manage.py 가 있는 프로젝트 폴더에서 <code>startapp</code> 명령어를 사용합니다. <code>startapp</code> 명령어를 사용해 <code>hello_world</code> 라는 이름의 앱을 만들어 줍니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">python manage.py startapp hello_world</span><br></pre></td></tr></table></figure><h4 id="view-py-작성하기"><a href="#view-py-작성하기" class="headerlink" title="view.py 작성하기"></a>view.py 작성하기</h4><p>앱 폴더 내에 <code>views.py</code> 파일에 다음과 같은 코드를 작성해줍니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">from django.http import HttpResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def hello(request):</span><br><span class="line">    <span class="built_in">return</span> HttpResponse(<span class="string">&quot;Hello, world. You&#x27;re at the hello_world index.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.]</span></span><br></pre></td></tr></table></figure><h4 id="url-py-작성하기"><a href="#url-py-작성하기" class="headerlink" title="url.py 작성하기"></a>url.py 작성하기</h4><p>프로젝트 폴더내 <code>url.py</code> 파일을 열어 <code>/hello</code> 경로와 해당 경로로 들어왔을때 보여줄 view 를 추가해줍니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">from hello_world.views import hello</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;hello/&#x27;</span>, hello),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="서비스-확인하기"><a href="#서비스-확인하기" class="headerlink" title="서비스 확인하기"></a>서비스 확인하기</h2><p><code>localhost:8080/hello</code> 로 접속하면 위 <code>view.py</code> 에서 작성한 내용이 보이는 것을 확인할 수 있습니다.</p><p><img src="/images/django/django_helloworld.png"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Programming/">Programming</category>
      
      <category domain="https://ckck803.github.io/categories/Programming/Django/">Django</category>
      
      
      
      <comments>https://ckck803.github.io/2023/12/09/django/django/create_app/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Django - 장고 시작하기</title>
      <link>https://ckck803.github.io/2023/12/09/django/django/start_django/</link>
      <guid>https://ckck803.github.io/2023/12/09/django/django/start_django/</guid>
      <pubDate>Sat, 09 Dec 2023 11:47:30 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/django/django.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/12/0</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/django/django.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/12/09/django/django/create_app/" title="Django - App 생성하기">Django - App 생성하기</a></li><li><a href="/2023/12/09/django/django/start_django/" title="Django - 장고 시작하기">Django - 장고 시작하기</a></li></ul><h2 id="장고-설치하기"><a href="#장고-설치하기" class="headerlink" title="장고 설치하기"></a>장고 설치하기</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install django</span><br></pre></td></tr></table></figure><h2 id="장고-프로젝트-생성하기-django-admin"><a href="#장고-프로젝트-생성하기-django-admin" class="headerlink" title="장고 프로젝트 생성하기 - django-admin"></a>장고 프로젝트 생성하기 - django-admin</h2><p>django 를 설치하면 <code>django-admin</code> 명령어를 사용할 수 있습니다. 설치된 <code>django-admin</code> 에 <code>startproject</code> 명령어를 사용하면 새롭게 장고 프로젝트를 시작할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">django-admin startproject mysite</span><br></pre></td></tr></table></figure><h2 id="장고-서버-실행하기-manage-py"><a href="#장고-서버-실행하기-manage-py" class="headerlink" title="장고 서버 실행하기 - manage.py"></a>장고 서버 실행하기 - manage.py</h2><p>새로운 장고 프로젝트에 들어가면 <code>manage.py</code> 파일이 있습니다. <code>runserver</code> 명령어를 사용하면 장고 서버를 실행할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">python manage.py runserver  </span><br></pre></td></tr></table></figure><p><img src="/images/django/django_run.png"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Programming/">Programming</category>
      
      <category domain="https://ckck803.github.io/categories/Programming/Django/">Django</category>
      
      
      
      <comments>https://ckck803.github.io/2023/12/09/django/django/start_django/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>React Query - 캐싱 라이프 사이클</title>
      <link>https://ckck803.github.io/2023/10/22/react/react-query/react-query-cache-stale/</link>
      <guid>https://ckck803.github.io/2023/10/22/react/react-query/react-query-cache-stale/</guid>
      <pubDate>Sun, 22 Oct 2023 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/react/react-query/react-query.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a </description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/react/react-query/react-query.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/10/22/react/react-query/react-query-cache-stale/" title="React Query - 캐싱 라이프 사이클">React Query - 캐싱 라이프 사이클</a></li><li><a href="/2023/10/22/react/react-query/react-query-devtools/" title="React Query - React Devtools 사용하기">React Query - React Devtools 사용하기</a></li><li><a href="/2023/10/22/react/react-query/react-query-start/" title="React Query - 시작하기">React Query - 시작하기</a></li></ul><h2 id="cache-와-stale-설정"><a href="#cache-와-stale-설정" class="headerlink" title="cache 와 stale 설정"></a>cache 와 stale 설정</h2><figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> queryClient = <span class="keyword">new</span> <span class="title class_">QueryClient</span>(&#123;</span><br><span class="line">  <span class="attr">defaultOptions</span>: &#123;</span><br><span class="line">    <span class="attr">queries</span>: &#123;</span><br><span class="line">      <span class="attr">staleTime</span>: <span class="number">1000</span> * <span class="number">60</span>,</span><br><span class="line">      <span class="attr">cacheTime</span>: <span class="number">1000</span> * <span class="number">60</span> * <span class="number">5</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params">&#123; Component, pageProps &#125;: AppProps</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...pageProps</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h2><p>React Query 는 설정한 cacheTime 만큼 데이터를 메모리에 저장해 놓습니다. 다시 이야기 하자면 React Query 에서의 Cache 는 QueryCache 객체의 <code>queries</code> 배열과 <code>queriesInMap</code> 객체의 Query 객체가 존재하는 것을 말합니다.</p><h2 id="cache-라이프-사이클-fresh-와-stale"><a href="#cache-라이프-사이클-fresh-와-stale" class="headerlink" title="cache 라이프 사이클 - fresh 와 stale"></a>cache 라이프 사이클 - fresh 와 stale</h2><p>stale 은 React Query 에서 cache 에 저장된 데이터 상태를 의미합니다. cache 에 저장된 데이터가 staleTime 만큼은 fresh 한 상태로 있다가 그 후에는 stale 상태로 넘어갑니다.</p><p>stale 상태의 데이터는 cache 에 오랫동안 저장돼 있어 refetch 가 필요한 상태임을 의미합니다. React Query 에서는 stale 상태의 데이터가 특정 조건을 만족하면 refetching 이 일어나도록 합니다.</p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/React/">React</category>
      
      <category domain="https://ckck803.github.io/categories/React/React-Query/">React Query</category>
      
      
      
      <comments>https://ckck803.github.io/2023/10/22/react/react-query/react-query-cache-stale/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>React Query - React Devtools 사용하기</title>
      <link>https://ckck803.github.io/2023/10/22/react/react-query/react-query-devtools/</link>
      <guid>https://ckck803.github.io/2023/10/22/react/react-query/react-query-devtools/</guid>
      <pubDate>Sun, 22 Oct 2023 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/react/react-query/react-query.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a </description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/react/react-query/react-query.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/10/22/react/react-query/react-query-cache-stale/" title="React Query - 캐싱 라이프 사이클">React Query - 캐싱 라이프 사이클</a></li><li><a href="/2023/10/22/react/react-query/react-query-devtools/" title="React Query - React Devtools 사용하기">React Query - React Devtools 사용하기</a></li><li><a href="/2023/10/22/react/react-query/react-query-start/" title="React Query - 시작하기">React Query - 시작하기</a></li></ul><h2 id="의존성-추가"><a href="#의존성-추가" class="headerlink" title="의존성 추가"></a>의존성 추가</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ npm i @tanstack/react-query-devtools</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ yarn add @tanstack/react-query-devtools</span><br></pre></td></tr></table></figure><h2 id="ReactQueryDevtools"><a href="#ReactQueryDevtools" class="headerlink" title="ReactQueryDevtools"></a>ReactQueryDevtools</h2><figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.tsx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactQueryDevtools</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query-devtools&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">QueryClient</span>, <span class="title class_">QueryClientProvider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> queryClient = <span class="keyword">new</span> <span class="title class_">QueryClient</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)!).<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ReactQueryDevtools</span> <span class="attr">initialIsOpen</span>=<span class="string">&#123;false&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/React/">React</category>
      
      <category domain="https://ckck803.github.io/categories/React/React-Query/">React Query</category>
      
      
      
      <comments>https://ckck803.github.io/2023/10/22/react/react-query/react-query-devtools/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>React Query - 시작하기</title>
      <link>https://ckck803.github.io/2023/10/22/react/react-query/react-query-start/</link>
      <guid>https://ckck803.github.io/2023/10/22/react/react-query/react-query-start/</guid>
      <pubDate>Sun, 22 Oct 2023 11:10:40 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/react/react-query/react-query.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a </description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/react/react-query/react-query.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/10/22/react/react-query/react-query-cache-stale/" title="React Query - 캐싱 라이프 사이클">React Query - 캐싱 라이프 사이클</a></li><li><a href="/2023/10/22/react/react-query/react-query-devtools/" title="React Query - React Devtools 사용하기">React Query - React Devtools 사용하기</a></li><li><a href="/2023/10/22/react/react-query/react-query-start/" title="React Query - 시작하기">React Query - 시작하기</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li>공식문서<ul><li><a href="https://tanstack.com/query/v4/docs/react/quick-start">https://tanstack.com/query/v4/docs/react/quick-start</a></li></ul></li></ul><h2 id="의존성-추가"><a href="#의존성-추가" class="headerlink" title="의존성 추가"></a>의존성 추가</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ npm i @tanstack/react-query</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ yarn add @tanstack/react-query</span><br></pre></td></tr></table></figure><h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.tsx&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">QueryClient</span>, <span class="title class_">QueryClientProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@tanstack/react-query&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> queryClient = <span class="keyword">new</span> <span class="title class_">QueryClient</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)!).<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="useQuery"><a href="#useQuery" class="headerlink" title="useQuery"></a>useQuery</h2><figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useQuery &#125; <span class="keyword">from</span> <span class="string">&quot;@tanstack/react-query&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isLoading, error, data &#125; = <span class="title function_">useQuery</span>(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&quot;repoData&quot;</span>],</span><br><span class="line">    <span class="attr">queryFn</span>: <span class="function">() =&gt;</span></span><br><span class="line">      axios</span><br><span class="line">        .<span class="title function_">get</span>(<span class="string">&quot;https://api.github.com/repos/TanStack/query&quot;</span>)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="property">data</span>),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isLoading) <span class="keyword">return</span> <span class="string">&quot;Loading...&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="string">&quot;An error has occurred: &quot;</span> + error.<span class="property">message</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;data.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;data.description&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>👀 &#123;data.subscribers_count&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&quot; &quot;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>✨ &#123;data.stargazers_count&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&quot; &quot;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>🍴 &#123;data.forks_count&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/React/">React</category>
      
      <category domain="https://ckck803.github.io/categories/React/React-Query/">React Query</category>
      
      
      
      <comments>https://ckck803.github.io/2023/10/22/react/react-query/react-query-start/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>JPA - 더티 체킹과 업데이트 그리고 벌크 연산</title>
      <link>https://ckck803.github.io/2023/09/08/jpa/jpa-update/</link>
      <guid>https://ckck803.github.io/2023/09/08/jpa/jpa-update/</guid>
      <pubDate>Thu, 07 Sep 2023 19:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/JPA/jpa.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;JPA-에서의-업데이트-더티-체킹&quot;&gt;&lt;a href=&quot;#JPA-에서의-업데이트-더티-체킹&quot; class=&quot;headerlink&quot; title=&quot;JPA 에서의 업데이트 - 더티</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/JPA/jpa.png"></p><h2 id="JPA-에서의-업데이트-더티-체킹"><a href="#JPA-에서의-업데이트-더티-체킹" class="headerlink" title="JPA 에서의 업데이트 - 더티 체킹"></a>JPA 에서의 업데이트 - 더티 체킹</h2><blockquote><p>Entity 에 대한 <code>더티 체킹</code> 을 통한 업데이트가 이뤄집니다.</p></blockquote><p>JPA 에서는 Entity 를 업데이트 하기 위한 메소드가 별도로 존재하지 않습니다. JPA 에서의 업데이트는 <strong>엔티티 변경</strong> 과 <strong>더티 체킹</strong> 을 통해 업데이트가 이뤄집니다.</p><p>JPA 에서 엔티티를 변경하기 위해서는 변경하고자 하는 엔티티를 조회한 후 해당 엔티티의 값을 변경하면 트랜잭션을 커밋할 때 변경 감지(Dirty Checking) 가 동작해서 데이터베이스에 UPDATE SQL 이 실행하는 방식으로 Entity 에 대한 변경을 반영합니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> ItemDto.Response <span class="title function_">modifyItemPrice</span><span class="params">(Long id, ItemDto.Request itemDto)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 변경하고자 하는 Entity 를 조회합니다.</span></span><br><span class="line">    Optional&lt;Item&gt; optionalItem = itemRepository.findById(id);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (optionalItem.isPresent()) &#123;</span><br><span class="line">        <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> optionalItem.get();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. Entity 의 값을 변경합니다.</span></span><br><span class="line">        item.updatePrice(itemDto.getPrice());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ItemDto.Response.toDto(item);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Item not found&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Update-쿼리문-발생"><a href="#Update-쿼리문-발생" class="headerlink" title="Update 쿼리문 발생"></a>Update 쿼리문 발생</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">update</span><br><span class="line">    item </span><br><span class="line">set</span><br><span class="line">    item_type_id=?,</span><br><span class="line">    modified_date=?,</span><br><span class="line">    name=?,</span><br><span class="line">    price=?,</span><br><span class="line">    version=? </span><br><span class="line">where</span><br><span class="line">    id=? </span><br><span class="line">    and version=?</span><br></pre></td></tr></table></figure><h2 id="더티체크를-통한-업데이트의-한계"><a href="#더티체크를-통한-업데이트의-한계" class="headerlink" title="더티체크를 통한 업데이트의 한계"></a>더티체크를 통한 업데이트의 한계</h2><p>더티 체킹을 통한 업데이트는 변경된 Entity 개수만큼 Update 문을 실행합니다. 그렇기 때문에 변경된 Entity 가 100개라면 100번의 Update 문이 실행되는 문제점이 있습니다.</p><p>그래서 JPA 에서는 벌크 연산을 통해 한번에 여러 Entity 를 변경할 수 있도록 지원합니다.</p><h2 id="벌크-연산을-통한-업데이트"><a href="#벌크-연산을-통한-업데이트" class="headerlink" title="벌크 연산을 통한 업데이트"></a>벌크 연산을 통한 업데이트</h2><h2 id="벌크-연산을-통한-업데이트의-한계"><a href="#벌크-연산을-통한-업데이트의-한계" class="headerlink" title="벌크 연산을 통한 업데이트의 한계"></a>벌크 연산을 통한 업데이트의 한계</h2><p>벌크 연상의 경우 JPA 를 통해서 업데이트하는 방식이 아니기 때문에 EntityManager 에서 캐싱해놓은 데이터와 DB 에 저장된 데이터의 불일치가 발생합니다.</p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Programming/">Programming</category>
      
      <category domain="https://ckck803.github.io/categories/Programming/JPA/">JPA</category>
      
      
      <category domain="https://ckck803.github.io/tags/JPA/">JPA</category>
      
      
      <comments>https://ckck803.github.io/2023/09/08/jpa/jpa-update/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Service Discovery 패턴</title>
      <link>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/</link>
      <guid>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/</guid>
      <pubDate>Fri, 30 Jun 2023 14:16:32 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;참고&quot;&gt;&lt;a href=&quot;#참고&quot; class=&quot;headerlink&quot; title=&quot;참고&quot;&gt;&lt;/a&gt;참고&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.nginx.com/blog/service-discovery-in-a-micro</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/">https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</a></li><li><a href="https://velog.io/@hoonki/%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%A8%ED%84%B4-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC">https:&#x2F;&#x2F;velog.io&#x2F;@hoonki&#x2F;마이크로서비스-패턴-서비스-디스커버리</a></li></ul><h2 id="Service-Discovery-패턴이-등장하게-된-배경"><a href="#Service-Discovery-패턴이-등장하게-된-배경" class="headerlink" title="Service Discovery 패턴이 등장하게 된 배경"></a>Service Discovery 패턴이 등장하게 된 배경</h2><p>기존 서비스 인스턴스의 개수와 IP 가 고정적이였던 온 프레미스 환경과 달리 MSA 환경에서는 Application 들이 AutoScaling 을 하면서 동적으로 줄었다가 늘어나면서 IP 자체도 동적으로 바뀌게 됐습니다.</p><p>Client 나 Gateway 입장에서 서비스 인스턴스들이 동적으로 늘었는지 줄었는지에 대한 파악을 하기가 어려운 문제가 있었고 그에 따른 LoadBalancing 하는데 어려움이 있었습니다.</p><p>Service Discovery 패턴에서는 Service EndPoint 를 조회 및 관리하기 위한 Service Registry 가 있습니다. MSA 의 각 서비스들은 Service Registry 에 자신의 EndPoint 들을 등록합니다.</p><p>Service EndPoint 를 접근하는 방식에 따라 두가지로 나뉘게 됩니다. 첫번째는 <code>Client-Side Discovery</code>  두번째는 <code>Server-Side Discovery</code> 패턴이 있습니다.</p><p><image src=/images/computer-science/network/http/before-service-discovery.png width=700><span class="caption">출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</span></p><h2 id="Client-Side-Discovery"><a href="#Client-Side-Discovery" class="headerlink" title="Client Side Discovery"></a>Client Side Discovery</h2><p>MSA 내 한 서비스가 다른 서비스를 호출할때 Service Registry 로 부터 EndPoint 를 조회한 후 해당 서비스를 호출하는 방식입니다.</p><p><image src=/images/computer-science/network/http/client-side-discovery.png width=650><span class="caption">출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</span></p><h2 id="Server-Side-Discovery"><a href="#Server-Side-Discovery" class="headerlink" title="Server Side Discovery"></a>Server Side Discovery</h2><p>Server Side Discovery 패턴은 기존 Client Side Discovery 와는 다르게 Service Registry 앞에 <code>Load Balancer</code> 를 두는 형태를 띄고 있습니다.</p><p>Server Side Discovery 는 Client Side Discovery 와 다르게 각 서비스간의 호출시에는 Load Balancer 를 통해 호출을 하게 되고 Load Balancer 가 Service Registry 에 등록된 EndPoint 들을 확인한 후 라우팅하는 방식입니다.</p><p>Server Side Discovery 패턴의 장점은 각각의 서비스 들에게 DNS 를 부여해 Domain 이름으로 호출할 수 있는 장점이 있고 Client Side Discovery 와는 달리 서비스 호출에 Load Balancer 를 거쳐야 하는 문제가 있어 Network Hop 이 늘어나는 단점이 있습니다.</p><p>쿠버네티스에서는 Server Side Discovery 를 제공합니다.</p><p><img src="/images/computer-science/network/http/server-side-discovery.png" alt="출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/CS/">CS</category>
      
      <category domain="https://ckck803.github.io/categories/CS/Network/">Network</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Cloud - Eureka 에 Service 등록하기</title>
      <link>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-client/</link>
      <guid>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-client/</guid>
      <pubDate>Thu, 29 Jun 2023 18:31:31 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/06/30/spring/spring-cloud/service-discovery/sprin</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-client/" title="Spring Cloud - Eureka 에 Service 등록하기">Spring Cloud - Eureka 에 Service 등록하기</a></li><li><a href="/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-server/" title="Spring Cloud - Service Discovery Server (Eureka)">Spring Cloud - Service Discovery Server (Eureka)</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/">https://cloud.spring.io/spring-cloud-netflix/reference/html/</a></li><li><a href="https://coe.gitbook.io/guide/service-discovery/eureka">https://coe.gitbook.io/guide/service-discovery/eureka</a></li></ul><h2 id="Service-등록하기"><a href="#Service-등록하기" class="headerlink" title="Service 등록하기"></a>Service 등록하기</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-client&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="EnableDiscoveryClient"><a href="#EnableDiscoveryClient" class="headerlink" title="@EnableDiscoveryClient"></a>@EnableDiscoveryClient</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        SpringApplication.run(UserServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Eureka-서버에-등록을-위한-Properties-설정-추가"><a href="#Eureka-서버에-등록을-위한-Properties-설정-추가" class="headerlink" title="Eureka 서버에 등록을 위한 Properties 설정 추가"></a>Eureka 서버에 등록을 위한 Properties 설정 추가</h2><p><code>eureka.client.register-with-eureka</code> 값을 true 로 줌으로써 Eureka 서버에 등록하도록 설정합니다. </p><p>Service 를 등록하기 위해 <code>eureka.client.service-url.defaultZone</code> 를 이용해 Eureka 서버의 주소를 설정합니다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka</span></span><br></pre></td></tr></table></figure><h2 id="Eureka-Server-에-등록된-Service-확인하기"><a href="#Eureka-Server-에-등록된-Service-확인하기" class="headerlink" title="Eureka Server 에 등록된 Service 확인하기"></a>Eureka Server 에 등록된 Service 확인하기</h2><p><img src="/images/springboot/msa/eureka-server-client.png" alt="Service 등록 후 Dashborad"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring/">Spring</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Cloud/">Spring Cloud</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Cloud/Service-Discovery/">Service Discovery</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-client/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Cloud - Service Discovery Server (Eureka)</title>
      <link>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-server/</link>
      <guid>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-server/</guid>
      <pubDate>Thu, 29 Jun 2023 17:31:31 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/06/30/spring/spring-cloud/service-discovery/sprin</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-client/" title="Spring Cloud - Eureka 에 Service 등록하기">Spring Cloud - Eureka 에 Service 등록하기</a></li><li><a href="/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-server/" title="Spring Cloud - Service Discovery Server (Eureka)">Spring Cloud - Service Discovery Server (Eureka)</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/">https://cloud.spring.io/spring-cloud-netflix/reference/html/</a></li><li><a href="https://coe.gitbook.io/guide/service-discovery/eureka">https://coe.gitbook.io/guide/service-discovery/eureka</a></li></ul><h2 id="사용하는-Spring-Cloud-버전"><a href="#사용하는-Spring-Cloud-버전" class="headerlink" title="사용하는 Spring Cloud 버전"></a>사용하는 Spring Cloud 버전</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;org.springframework.boot&#x27;</span> version <span class="string">&#x27;2.4.5&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;io.spring.dependency-management&#x27;</span> version <span class="string">&#x27;1.0.11.RELEASE&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;java&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">group = <span class="string">&#x27;com.example&#x27;</span></span><br><span class="line">version = <span class="string">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class="line">sourceCompatibility = <span class="string">&#x27;11&#x27;</span></span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ext &#123;</span><br><span class="line">    set(<span class="string">&#x27;springCloudVersion&#x27;</span>, <span class="string">&quot;2020.0.2&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    testImplementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencyManagement &#123;</span><br><span class="line">    imports &#123;</span><br><span class="line">        mavenBom <span class="string">&quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test &#123;</span><br><span class="line">    useJUnitPlatform()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Spring-Cloud-Eureka"><a href="#Spring-Cloud-Eureka" class="headerlink" title="Spring Cloud Eureka"></a>Spring Cloud Eureka</h2><p>MSA (Micro Service Architecture) 에서는 각 서비스를 관리하기 위해서 Service Discovery Server 가 필요합니다. Spring Cloud 에서는 Service Discovery 를 위해 Eureka 를 사용한다.</p><h2 id="Discovery-Server-Eureka"><a href="#Discovery-Server-Eureka" class="headerlink" title="Discovery Server (Eureka)"></a>Discovery Server (Eureka)</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-server&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="EnableEurekaServer"><a href="#EnableEurekaServer" class="headerlink" title="@EnableEurekaServer"></a>@EnableEurekaServer</h2><p>Discovery Server 로 작동하기 위해 <code>@EnableEurekaServer</code> 어노테이션을 추가하여 Eureka Server 를 구성합니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiscoveryServiceApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DiscoveryServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Properties-설정-추가"><a href="#Properties-설정-추가" class="headerlink" title="Properties 설정 추가"></a>Properties 설정 추가</h2><ul><li><code>eureka.client.register-with-eureka</code><ul><li>레지스트리 서버에 본인을 등록할지 여부를 설정합니다.</li></ul></li><li><code>eureka.client.fetch-registry</code><ul><li>레지스트리 정보를 가져올지 여부를 설정합니다.</li></ul></li></ul><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">discoveryservice</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span> </span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><img src="/images/springboot/msa/eureka-server.png" alt="Eureka Server Dashboard"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring/">Spring</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Cloud/">Spring Cloud</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Cloud/Service-Discovery/">Service Discovery</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/30/spring/spring-cloud/service-discovery/spring-cloud-eureka-server/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - 배치 설정 (application.properties)</title>
      <link>https://ckck803.github.io/2023/06/28/spring/spring-batch/spring-batch-batch-properties/</link>
      <guid>https://ckck803.github.io/2023/06/28/spring/spring-batch/spring-batch-batch-properties/</guid>
      <pubDate>Wed, 28 Jun 2023 06:25:35 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/spring-batch/spring-batch.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;배치-잡의-실행-여부를-설정&quot;&gt;&lt;a href=&quot;#배치-잡의-실행-여부를-설정&quot; class=&quot;headerlink&quot; title=&quot;배치 잡의</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/spring-batch/spring-batch.jpg"></p><h2 id="배치-잡의-실행-여부를-설정"><a href="#배치-잡의-실행-여부를-설정" class="headerlink" title="배치 잡의 실행 여부를 설정"></a>배치 잡의 실행 여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Spring Boot 가 자동으로 실행시키는 Batch Job 을 실행시키도록 한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.enabled:</span> <span class="literal">true</span> <span class="comment"># default</span></span><br><span class="line"><span class="comment"># Spring Boot 가 자동으로 실행시키는 Batch Job 을 실행하지 않도록 한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡의-재시작-여부를-설정"><a href="#배치-잡의-재시작-여부를-설정" class="headerlink" title="배치 잡의 재시작 여부를 설정"></a>배치 잡의 재시작 여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 기본이 true, 재시작을 허용한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.restartable:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># 재시작을 허용하지 않는다</span></span><br><span class="line"><span class="attr">spring.batch.job.restartable:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="실행할-배치-잡의-이름을-지정"><a href="#실행할-배치-잡의-이름을-지정" class="headerlink" title="실행할 배치 잡의 이름을 지정"></a>실행할 배치 잡의 이름을 지정</h2><p>스프링 배치는 실행시 기본적으로 모든 Job 을 실행시킵니다. <code>spring.batch.job.names</code> 를 이용해 지정 Job 만 실행하도록 설정할 수 있습니다. </p><p>프로그램 실행시 특정 Job 을 전달받아 실행시키고 싶을 경우 <code>spring.batch.job.names: $&#123;job.name:NONE&#125;</code> 로 설정하면 외부에서 주입받은 Job 이름을 이용해 실행시킬 수 있습니다. 만일 전달받은 값이 없으면 아무 Job 도 실행시키지 않습니다.</p><p><code>:NONE</code> 은 프로퍼티 표현 중 하나로 전달받은 값이 없을 경우 NONE 으로 대체한다는 의미이다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Hard Coding 방식</span></span><br><span class="line"><span class="attr">spring.batch.job.names:</span> <span class="string">springJob1</span></span><br><span class="line"><span class="comment"># Binding 을 사용한 방식</span></span><br><span class="line"><span class="attr">spring.batch.job.names:</span> <span class="string">$&#123;job.name:NONE&#125;</span> </span><br></pre></td></tr></table></figure><h4 id="실행시킬-Job-을-지정하는-방법"><a href="#실행시킬-Job-을-지정하는-방법" class="headerlink" title="실행시킬 Job 을 지정하는 방법"></a>실행시킬 Job 을 지정하는 방법</h4><ul><li>어플리케이션 실행시 Program arguments 로 Job 이름 입력한다.<ul><li><code>--job.name=helloJob</code></li></ul></li><li>하나 이상의 Job 을 실행할 경우 쉼표로 구분해서 입력 한다.<ul><li><code>--job.name=helloJob,simpleJob</code></li></ul></li></ul><p>어플리케이션 실행시점에 Argument 로 넘겨서 Binding 되도록 한다.</p><p><image src=/images/spring-batch/ch4/job_name_properties.png width=750><span class="caption">인텔리제이에서 Program Argument 를 이용한 Job 실행</span></p><h2 id="배치-메타-데이터-저장을-위한-테이블-스키마-자동-생성여부를-설정"><a href="#배치-메타-데이터-저장을-위한-테이블-스키마-자동-생성여부를-설정" class="headerlink" title="배치 메타 데이터 저장을 위한 테이블 스키마 자동 생성여부를 설정"></a>배치 메타 데이터 저장을 위한 테이블 스키마 자동 생성여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">embedded</span> <span class="comment"># default</span></span><br><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">never</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡에서-생성되는-메타-데이터-테이블-Prefix-를-설정"><a href="#배치-잡에서-생성되는-메타-데이터-테이블-Prefix-를-설정" class="headerlink" title="배치 잡에서 생성되는 메타 데이터 테이블 Prefix 를 설정"></a>배치 잡에서 생성되는 메타 데이터 테이블 Prefix 를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.batch.jdbc.table-prefix:</span>  <span class="string">DEMO</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡에서-허용하는-실패-횟수를-설정"><a href="#배치-잡에서-허용하는-실패-횟수를-설정" class="headerlink" title="배치 잡에서 허용하는 실패 횟수를 설정"></a>배치 잡에서 허용하는 실패 횟수를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 배치 잡에서 허용하는 실패 횟수를 설정한다. default: 3</span></span><br><span class="line"><span class="attr">spring.batch.job.failures-allowed:</span> <span class="number">3</span> </span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring/">Spring</category>
      
      <category domain="https://ckck803.github.io/categories/Spring/Spring-Batch/">Spring Batch</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/28/spring/spring-batch/spring-batch-batch-properties/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - ServiceAccount</title>
      <link>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/</link>
      <guid>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/</guid>
      <pubDate>Sun, 11 Jun 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;!-- ![](/images/k8s/helm/helm.png) --&gt;

&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<!-- ![](/images/k8s/helm/helm.png) --><p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/07/k8s/secret/" title="쿠버네티스 - Secret">쿠버네티스 - Secret</a></li><li><a href="/2023/05/07/k8s/configmap/" title="쿠버네티스 - ConfigMap">쿠버네티스 - ConfigMap</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="/2023/05/07/k8s/data_plane/" title="쿠버네티스 - Data Plane">쿠버네티스 - Data Plane</a></li><li><a href="/2023/05/07/k8s/control_plane/" title="쿠버네티스 - Control Plane">쿠버네티스 - Control Plane</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://findstar.pe.kr/2023/04/09/access-k8s-api-from-pod/">https://findstar.pe.kr/2023/04/09/access-k8s-api-from-pod/</a></li><li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</a></li><li><a href="https://kubernetes.io/ko/docs/reference/access-authn-authz/service-accounts-admin/">https://kubernetes.io/ko/docs/reference/access-authn-authz/service-accounts-admin/</a></li></ul><h2 id="ServiceAccount"><a href="#ServiceAccount" class="headerlink" title="ServiceAccount"></a>ServiceAccount</h2><blockquote><p>ServiceAccount 는 쿠버네티스 API 서버와 통신하고 클러스터 내의 다른 리소스에 접근하기 위한 인증 정보를 제공합니다.</p></blockquote><!-- ServiceAccount는 쿠버네티스 API 서버와 통신하고 클러스터 내의 다른 리소스에 접근하기 위한 인증 정보를 제공합니다.ServiceAccount 는 Pod 에서 클러스터를 조작하고 싶을 경우 kube-apiserver 에 접근이 가능하도록 권한을 부여하는 리소스입니다.일반적으로 쿠버네티스에서 애플리케이션은 Pod라는 단위로 실행됩니다. Pod 내부의 애플리케이션은 ServiceAccount를 사용하여 클러스터 내의 다른 리소스와 상호 작용할 수 있습니다. 각 Pod는 자체적으로 고유한 ServiceAccount를 가질 수 있으며, 이를 통해 해당 Pod의 애플리케이션이 클러스터 리소스에 접근할 수 있는 권한을 부여받을 수 있습니다.ServiceAccount는 클러스터 내에서 사용자 계정과 동일한 역할을 합니다. 즉, 각 ServiceAccount는 클러스터 내에서 고유한 식별자를 가지고 있으며, 해당 ServiceAccount에는 롤(Role) 또는 클러스터 롤(ClusterRole)이 할당될 수 있습니다. 롤 및 클러스터 롤은 애플리케이션에 대한 특정 작업(예: 리소스 생성, 수정, 삭제)을 수행할 수 있는 권한을 정의합니다.ServiceAccount는 Pod를 생성할 때 자동으로 생성되며, Pod의 spec에 ServiceAccount 이름을 명시하여 특정 ServiceAccount를 할당할 수 있습니다. 애플리케이션은 이 할당된 ServiceAccount를 사용하여 클러스터 내의 리소스에 접근하고 API 호출을 수행합니다. --><p>ServiceAccount 는 Pod 가 Kubernetes API Server 에 인증 하기 위한 Account 입니다. 때문에 Pod 를 생성할때 ServiceAccount 를 할당해야 하며 지정하지 않을 경우 <strong>default</strong> 가 자동으로 할당됩니다.</p><p>Rule 과 RuleBinding 을 이용해 ServiceAccount 에 권한을 부여함으로써 Pod 가 다른 리소스에 접근할 수 있게 해줍니다.</p><p>ServiceAccount 는 Namespace 단위로 생성되는 리소스며 다른 Namespace 에서 정의된 ServiceAccount 를 사용할 수 없습니다.</p><h2 id="ServiceAccount-생성하기"><a href="#ServiceAccount-생성하기" class="headerlink" title="ServiceAccount 생성하기"></a>ServiceAccount 생성하기</h2><p>매니페스트 내 <code>kind: ServiceAccount</code> 를 사용하여 ServiceAccount를 생성할 수 있습니다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">ServiceAccount</span> <span class="string">에</span> <span class="string">대한</span> <span class="string">설명</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">이름&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">를</span> <span class="string">사용할</span> <span class="string">Namespace&gt;</span> </span><br></pre></td></tr></table></figure><h2 id="Token-생성"><a href="#Token-생성" class="headerlink" title="Token 생성"></a>Token 생성</h2><p>v1.22 이전 버전의 쿠버네티스 버전은 쿠버네티스 API에 액세스하기 위한 장기 자격 증명을 자동으로 생성했다. 이 이전 메커니즘은 실행 중인 파드에 마운트할 수 있는 토큰 시크릿을 생성하는 것을 기반으로 했다. 쿠버네티스 v1.27을 포함한 최신 버전에서는, API 자격 증명이 토큰리퀘스트 API를 사용하여 직접 획득되고, 예상 볼륨을 사용하여 파드에 마운트된다. 이 방법을 사용하여 획득한 토큰은 수명이 제한되어 있으며, 마운트된 파드가 삭제되면 자동으로 무효화된다.</p><p>예를 들어 만료되지 않는 토큰이 필요한 경우 서비스 어카운트 토큰 시크릿을 수동으로 생성할 수 있다. 그러나 대신 TokenRequest 서브리소스를 사용하여 API에 액세스하기 위한 토큰을 얻는 것을 권장한다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create token &lt;ServiceAccount Name&gt;</span><br></pre></td></tr></table></figure><h2 id="Secret-생성"><a href="#Secret-생성" class="headerlink" title="Secret 생성"></a>Secret 생성</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Secret</span> <span class="string">Name&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/service-account.name:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">Name&gt;</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">kubernetes.io/service-account-token</span></span><br></pre></td></tr></table></figure><h2 id="Rule"><a href="#Rule" class="headerlink" title="Rule"></a>Rule</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubectl-prometheus-alertmanager-role</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">apiGroups:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">apps</span></span><br><span class="line">  <span class="attr">resourceNames:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">prometheus-alertmanager</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">alertmanager</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">statefulsets</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">statefulsets/scale</span></span><br><span class="line">  <span class="attr">verbs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">get</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">patch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">list</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">watch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">update</span></span><br></pre></td></tr></table></figure><h2 id="RoleBinding"><a href="#RoleBinding" class="headerlink" title="RoleBinding"></a>RoleBinding</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">RoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubectl-prometheus-alertmanager-rolebinding</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Role</span> <span class="string">Name&gt;</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Service</span> <span class="string">Account</span> <span class="string">Name&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Config/">Config</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Istio - istioctl2</title>
      <link>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/</link>
      <guid>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/</guid>
      <pubDate>Thu, 25 May 2023 23:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/istio/istio.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/istio/istio.jpg"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/08/k8s/istio/istio-locality_load_balacing/" title="Istio - Locality Load Balancing (지역 로드 밸런싱)">Istio - Locality Load Balancing (지역 로드 밸런싱)</a></li><li><a href="/2023/05/08/k8s/istio/istio-injection/" title="Istio - Sidecar Injection">Istio - Sidecar Injection</a></li><li><a href="/2023/05/08/k8s/istio/istio-istioctl/" title="Istio - istioctl">Istio - istioctl</a></li><li><a href="/2023/05/08/k8s/istio/istio/" title="Istio 란?">Istio 란?</a></li></ul><h2 id="공식-홈페이지"><a href="#공식-홈페이지" class="headerlink" title="공식 홈페이지"></a>공식 홈페이지</h2><ul><li><a href="https://istio.io/latest/docs/setup/getting-started/">https://istio.io/latest/docs/setup/getting-started/</a></li></ul><h2 id="istioctl-설치"><a href="#istioctl-설치" class="headerlink" title="istioctl 설치"></a>istioctl 설치</h2><p>Mac 을 사용하는 경우 HomeBrew 를 이용해 istioctl 을 설치할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">brew install istioctl</span><br></pre></td></tr></table></figure><p>다른 OS 를 사용하거나 특정 버전의 Istio 를 사용하고 싶은 경우 다음과 같이 Istio 버전을 Setting 한 후 해당 버전을 내려받아 사용할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ISTIO_VERSION=1.14.5</span><br><span class="line">curl -L https://istio.io/downloadIstio | ISTIO_VERSION=<span class="variable">$ISTIO_VERSION</span> TARGET_ARCH=x86_64 sh -</span><br></pre></td></tr></table></figure><h2 id="Istio-Profile-설치"><a href="#Istio-Profile-설치" class="headerlink" title="Istio Profile 설치"></a>Istio Profile 설치</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">istioctl install --<span class="built_in">set</span> profile=demo --<span class="built_in">set</span> hub=gcr.io/istio-release</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/istio-demo2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f samples/addons</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/install-addons.png"></p><h4 id="설치된-Istio-Resource"><a href="#설치된-Istio-Resource" class="headerlink" title="설치된 Istio Resource"></a>설치된 Istio Resource</h4><p><img src="/images/k8s/istio/tutorial/addons-all-resources.png"></p><h2 id="Kiali"><a href="#Kiali" class="headerlink" title="Kiali"></a>Kiali</h2><p>외부에서 접근이 가능하도록 Kiali Service 를 ClusterIP 에서 LoadBalancer 로 변경합니다</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch svc kiali -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/kiali-svc-patch.png) --><p>LoadBalancer 로 변경 되면서 <code>EXTERNAL-IP</code> 가 추가된 것을 확인할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/k9s-kiali-svc.png" alt="Kiali Service 의 EXTERNAL-IP 확인"></p><p>EXTERNAL-IP 를 이용해 접근하면 Kiali Dashboard 로 접근할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-kiali-dashboard2.png" alt="Kiali Dashboard"></p><h2 id="Jaeger"><a href="#Jaeger" class="headerlink" title="Jaeger"></a>Jaeger</h2><p>외부에서 접근이 가능하도록 Jaeger Service 를 ClusterIP 에서 LoadBalancer 로 변경합니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch svc tracing -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/jaeger-svc-patch.png) --><p>LoadBalancer 로 변경 되면서 <code>EXTERNAL-IP</code> 가 추가된 것을 확인할 수 있다.</p><p><img src="/images/k8s/istio/tutorial/k9s-jaeger-svc.png" alt="Jaeger Service 의 EXTERNAL-IP 확인"></p><p>EXTERNAL-IP 를 이용해 접근하면 Jaeger Dashboard 로 접근할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-jaeger-dashboard.png" alt="Jaeger Dashboard"></p><h2 id="Sidecar-Injection-방법"><a href="#Sidecar-Injection-방법" class="headerlink" title="Sidecar Injection 방법"></a>Sidecar Injection 방법</h2><ul><li><em><code>Istioctl kube-inject Command</code> 를 이용하는 방법</em></li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f Deployment.yml)</span><br></pre></td></tr></table></figure><ul><li><em>Namespace 에 <code>istio-injection</code> 을 enabled 로 설정하는 방법</em></li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl label namespace tutorial istio-injection=enabled</span><br></pre></td></tr></table></figure><h2 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create namespace tutorial</span><br></pre></td></tr></table></figure><p>Deployment 를 설치 할때 <code>istioctl kube-inject</code> 명령어를 통해 Istio Container 가 Pod 내에 설치되도록 설정합니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f customer/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f customer/kubernetes/Service.yml -n tutorial</span><br></pre></td></tr></table></figure><p>Pod 가 생성될때 내부에 Istio Container 가 생성된 것을 확인할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-customer.png" alt="customer Pod 에 설치된 Container 목록"></p><h4 id="Istio-Gateway-설치-및-Customer-서비스-라우팅-VirtualService-설정"><a href="#Istio-Gateway-설치-및-Customer-서비스-라우팅-VirtualService-설정" class="headerlink" title="Istio Gateway 설치 및 Customer 서비스 라우팅(VirtualService) 설정"></a>Istio Gateway 설치 및 Customer 서비스 라우팅(VirtualService) 설정</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: Gateway</span><br><span class="line">metadata:</span><br><span class="line">  name: customer-gateway</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    istio: ingressgateway <span class="comment"># use istio default controller</span></span><br><span class="line">  servers:</span><br><span class="line">  - port:</span><br><span class="line">      number: 80</span><br><span class="line">      name: http</span><br><span class="line">      protocol: HTTP</span><br><span class="line">    hosts:</span><br><span class="line">    - <span class="string">&quot;*&quot;</span></span><br><span class="line">---</span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">  name: customer-gateway</span><br><span class="line">spec:</span><br><span class="line">  hosts:</span><br><span class="line">  - <span class="string">&quot;*&quot;</span></span><br><span class="line">  gateways:</span><br><span class="line">  - customer-gateway</span><br><span class="line">  http:</span><br><span class="line">  - match:</span><br><span class="line">    - uri:</span><br><span class="line">        prefix: /customer</span><br><span class="line">    rewrite:</span><br><span class="line">      uri: /</span><br><span class="line">    route:</span><br><span class="line">    - destination:</span><br><span class="line">        host: customer</span><br><span class="line">        port:</span><br><span class="line">          number: 8080</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f customer/kubernetes/Gateway.yml -n tutorial</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f preference/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f preference/kubernetes/Service.yml -n tutorial</span><br><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f recommendation/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f recommendation/kubernetes/Service.yml -n tutorial</span><br></pre></td></tr></table></figure><h2 id="Istio-Traffic-Routing"><a href="#Istio-Traffic-Routing" class="headerlink" title="Istio - Traffic Routing"></a>Istio - Traffic Routing</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f recommendation/kubernetes/Deployment-v2.yml) -n tutorial</span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/deploy-2.png) --><p><img src="/images/k8s/istio/tutorial/deploy-v2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl scale --replicas=2 deployment/recommendation-v2 -n tutorial</span><br><span class="line">kubectl get po -n tutorial</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/scale-2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl get VirtualService -n tutorial -o yaml</span><br><span class="line">kubectl get DestinationRule -n tutorial -o yaml</span><br></pre></td></tr></table></figure><h2 id="Istio-Timeout-Retry"><a href="#Istio-Timeout-Retry" class="headerlink" title="Istio Timeout &amp; Retry"></a>Istio Timeout &amp; Retry</h2><h4 id="Timeout-설정"><a href="#Timeout-설정" class="headerlink" title="Timeout 설정"></a>Timeout 설정</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">    apiVersion: networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="string">    kind: VirtualService</span></span><br><span class="line"><span class="string">    metadata:</span></span><br><span class="line"><span class="string">      name: vs-order-network-rule</span></span><br><span class="line"><span class="string">      namespace: tutorial</span></span><br><span class="line"><span class="string">    spec:</span></span><br><span class="line"><span class="string">      hosts:</span></span><br><span class="line"><span class="string">      - order</span></span><br><span class="line"><span class="string">      http:</span></span><br><span class="line"><span class="string">      - route:</span></span><br><span class="line"><span class="string">        - destination:</span></span><br><span class="line"><span class="string">            host: order</span></span><br><span class="line"><span class="string">        timeout: 3s</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h4 id="Siege-생성"><a href="#Siege-생성" class="headerlink" title="Siege 생성"></a>Siege 생성</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">apiVersion: v1</span></span><br><span class="line"><span class="string">kind: Pod</span></span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="string">  name: siege</span></span><br><span class="line"><span class="string">  namespace: tutorial</span></span><br><span class="line"><span class="string">spec:</span></span><br><span class="line"><span class="string">  containers:</span></span><br><span class="line"><span class="string">  - name: siege</span></span><br><span class="line"><span class="string">    image: apexacme/siege-nginx</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it siege -c siege -n tutorial -- /bin/bash</span><br><span class="line">siege -c1 -t2S -v --content-type <span class="string">&quot;application/json&quot;</span> <span class="string">&#x27;http://order:8080/orders POST &#123;&quot;productId&quot;: &quot;1001&quot;, &quot;qty&quot;:5&#125;&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">siege -c30 -t20S -v --content-type <span class="string">&quot;application/json&quot;</span> <span class="string">&#x27;http://order:8080/orders POST &#123;&quot;productId&quot;: &quot;1001&quot;, &quot;qty&quot;:5&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/siege-kiali.png"></p><h4 id="Order-서비스에-‘Retry’-Rule-추가"><a href="#Order-서비스에-‘Retry’-Rule-추가" class="headerlink" title="Order 서비스에 ‘Retry’ Rule 추가"></a>Order 서비스에 ‘Retry’ Rule 추가</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">  apiVersion: networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="string">  kind: VirtualService</span></span><br><span class="line"><span class="string">  metadata:</span></span><br><span class="line"><span class="string">    name: vs-order-network-rule</span></span><br><span class="line"><span class="string">    namespace: tutorial</span></span><br><span class="line"><span class="string">  spec:</span></span><br><span class="line"><span class="string">    hosts:</span></span><br><span class="line"><span class="string">    - order</span></span><br><span class="line"><span class="string">    http:</span></span><br><span class="line"><span class="string">    - route:</span></span><br><span class="line"><span class="string">      - destination:</span></span><br><span class="line"><span class="string">          host: order</span></span><br><span class="line"><span class="string">      timeout: 3s</span></span><br><span class="line"><span class="string">      retries:</span></span><br><span class="line"><span class="string">        attempts: 3</span></span><br><span class="line"><span class="string">        perTryTimeout: 2s</span></span><br><span class="line"><span class="string">        retryOn: 5xx,retriable-4xx,gateway-error,connect-failure,refused-stream</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">&quot;Ingress&quot;</span></span><br><span class="line"><span class="attr">metadata:</span> </span><br><span class="line">  <span class="attr">name:</span> <span class="string">&quot;shopping-ingress&quot;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">&quot;istio-system&quot;</span>  </span><br><span class="line">  <span class="attr">annotations:</span> </span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/ssl-redirect:</span> <span class="string">&quot;false&quot;</span></span><br><span class="line">    <span class="attr">ingressclass.kubernetes.io/is-default-class:</span> <span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="attr">spec:</span> </span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;kiali.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">kiali</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">20001</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;prom.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">prometheus</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">9090</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;gra.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">grafana</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">3000</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;tracing.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">tracing</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><h2 id="Prometheus-Grafana기반-K8s-통합-모니터링"><a href="#Prometheus-Grafana기반-K8s-통합-모니터링" class="headerlink" title="Prometheus&#x2F;Grafana기반 K8s 통합 모니터링"></a>Prometheus&#x2F;Grafana기반 K8s 통합 모니터링</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create ns shop</span><br><span class="line">kubectl label namespace shop istio-injection=enabled</span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/order-liveness.yaml -n shop</span><br><span class="line">kubectl expose deploy order --port=8080 -n shop</span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/delivery-rediness-v1.yaml -n shop</span><br><span class="line">kubectl expose deploy delivery --port=8080 -n shop</span><br><span class="line"><span class="comment"># Client Pod deploy</span></span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/siege-pod.yaml -n shop</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch service/prometheus -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/prometheus-dashboard.png" alt="Prometheus Dashboard"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch service/grafana -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/spring-framework/grafana-dashboard.png" alt="Grafana Dashboard"></p><h2 id="Istio-삭제-방법"><a href="#Istio-삭제-방법" class="headerlink" title="Istio 삭제 방법"></a>Istio 삭제 방법</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> istio-<span class="variable">$ISTIO_VERSION</span></span><br><span class="line">kubectl delete -f samples/addons</span><br><span class="line">istioctl manifest generate --<span class="built_in">set</span> profile=demo | kubectl delete --ignore-not-found=<span class="literal">true</span> -f -</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl delete namespace istio-system</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Istio/">Istio</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - CA (Cluster Autoscaler)</title>
      <link>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/</link>
      <guid>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/</guid>
      <pubDate>Thu, 18 May 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05/18/k8s/</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/18/k8s/deployment/hpa/" title="쿠버네티스 - HPA (Horizontal Pod Autoscaler)">쿠버네티스 - HPA (Horizontal Pod Autoscaler)</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h2>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Autoscaler/">Autoscaler</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
