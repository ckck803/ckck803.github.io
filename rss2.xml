<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Victor</title>
    <link>https://ckck803.github.io/</link>
    
    <atom:link href="https://ckck803.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>개발 노트</description>
    <pubDate>Sun, 18 Feb 2024 16:39:23 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title></title>
      <link>https://ckck803.github.io/2024/02/19/k8s/metric-server/</link>
      <guid>https://ckck803.github.io/2024/02/19/k8s/metric-server/</guid>
      <pubDate>Sun, 18 Feb 2024 16:39:23 GMT</pubDate>
      
      
      
      
      
      
      <comments>https://ckck803.github.io/2024/02/19/k8s/metric-server/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title></title>
      <link>https://ckck803.github.io/2024/02/19/database/oracle/install/</link>
      <guid>https://ckck803.github.io/2024/02/19/database/oracle/install/</guid>
      <pubDate>Sun, 18 Feb 2024 16:39:23 GMT</pubDate>
      
      
      
      
      
      
      <comments>https://ckck803.github.io/2024/02/19/database/oracle/install/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Service Discovery 패턴</title>
      <link>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/</link>
      <guid>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/</guid>
      <pubDate>Fri, 30 Jun 2023 14:16:32 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;참고&quot;&gt;&lt;a href=&quot;#참고&quot; class=&quot;headerlink&quot; title=&quot;참고&quot;&gt;&lt;/a&gt;참고&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.nginx.com/blog/service-discovery-in-a-micro</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/">https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</a></li><li><a href="https://velog.io/@hoonki/%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%A8%ED%84%B4-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC">https:&#x2F;&#x2F;velog.io&#x2F;@hoonki&#x2F;마이크로서비스-패턴-서비스-디스커버리</a></li></ul><h2 id="Service-Discovery-패턴이-등장하게-된-배경"><a href="#Service-Discovery-패턴이-등장하게-된-배경" class="headerlink" title="Service Discovery 패턴이 등장하게 된 배경"></a>Service Discovery 패턴이 등장하게 된 배경</h2><p>기존 서비스 인스턴스의 개수와 IP 가 고정적이였던 온 프레미스 환경과 달리 MSA 환경에서는 Application 들이 AutoScaling 을 하면서 동적으로 줄었다가 늘어나면서 IP 자체도 동적으로 바뀌게 됐습니다.</p><p>Client 나 Gateway 입장에서 서비스 인스턴스들이 동적으로 늘었는지 줄었는지에 대한 파악을 하기가 어려운 문제가 있었고 그에 따른 LoadBalancing 하는데 어려움이 있었습니다.</p><p>Service Discovery 패턴에서는 Service EndPoint 를 조회 및 관리하기 위한 Service Registry 가 있습니다. MSA 의 각 서비스들은 Service Registry 에 자신의 EndPoint 들을 등록합니다.</p><p>Service EndPoint 를 접근하는 방식에 따라 두가지로 나뉘게 됩니다. 첫번째는 <code>Client-Side Discovery</code>  두번째는 <code>Server-Side Discovery</code> 패턴이 있습니다.</p><p><image src=/images/computer-science/network/http/before-service-discovery.png width=700><span class="caption">출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</span></p><h2 id="Client-Side-Discovery"><a href="#Client-Side-Discovery" class="headerlink" title="Client Side Discovery"></a>Client Side Discovery</h2><p>MSA 내 한 서비스가 다른 서비스를 호출할때 Service Registry 로 부터 EndPoint 를 조회한 후 해당 서비스를 호출하는 방식입니다.</p><p><image src=/images/computer-science/network/http/client-side-discovery.png width=650><span class="caption">출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/</span></p><h2 id="Server-Side-Discovery"><a href="#Server-Side-Discovery" class="headerlink" title="Server Side Discovery"></a>Server Side Discovery</h2><p>Server Side Discovery 패턴은 기존 Client Side Discovery 와는 다르게 Service Registry 앞에 <code>Load Balancer</code> 를 두는 형태를 띄고 있습니다.</p><p>Server Side Discovery 는 Client Side Discovery 와 다르게 각 서비스간의 호출시에는 Load Balancer 를 통해 호출을 하게 되고 Load Balancer 가 Service Registry 에 등록된 EndPoint 들을 확인한 후 라우팅하는 방식입니다.</p><p>Server Side Discovery 패턴의 장점은 각각의 서비스 들에게 DNS 를 부여해 Domain 이름으로 호출할 수 있는 장점이 있고 Client Side Discovery 와는 달리 서비스 호출에 Load Balancer 를 거쳐야 하는 문제가 있어 Network Hop 이 늘어나는 단점이 있습니다.</p><p>쿠버네티스에서는 Server Side Discovery 를 제공합니다.</p><p><img src="/images/computer-science/network/http/server-side-discovery.png" alt="출처: https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/CS/">CS</category>
      
      <category domain="https://ckck803.github.io/categories/CS/Network/">Network</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/30/computer-science/network/ServiceDiscovery/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Cloud - Eureka 에 Service 등록하기</title>
      <link>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-client/</link>
      <guid>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-client/</guid>
      <pubDate>Thu, 29 Jun 2023 18:31:31 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/06/30/springboot/spring-cloud/service-discovery/s</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-client/" title="Spring Cloud - Eureka 에 Service 등록하기">Spring Cloud - Eureka 에 Service 등록하기</a></li><li><a href="/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-server/" title="Spring Cloud - Service Discovery Server (Eureka)">Spring Cloud - Service Discovery Server (Eureka)</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/">https://cloud.spring.io/spring-cloud-netflix/reference/html/</a></li><li><a href="https://coe.gitbook.io/guide/service-discovery/eureka">https://coe.gitbook.io/guide/service-discovery/eureka</a></li></ul><h2 id="Service-등록하기"><a href="#Service-등록하기" class="headerlink" title="Service 등록하기"></a>Service 등록하기</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-client&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="EnableDiscoveryClient"><a href="#EnableDiscoveryClient" class="headerlink" title="@EnableDiscoveryClient"></a>@EnableDiscoveryClient</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        SpringApplication.run(UserServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Eureka-서버에-등록을-위한-Properties-설정-추가"><a href="#Eureka-서버에-등록을-위한-Properties-설정-추가" class="headerlink" title="Eureka 서버에 등록을 위한 Properties 설정 추가"></a>Eureka 서버에 등록을 위한 Properties 설정 추가</h2><p><code>eureka.client.register-with-eureka</code> 값을 true 로 줌으로써 Eureka 서버에 등록하도록 설정합니다. </p><p>Service 를 등록하기 위해 <code>eureka.client.service-url.defaultZone</code> 를 이용해 Eureka 서버의 주소를 설정합니다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka</span></span><br></pre></td></tr></table></figure><h2 id="Eureka-Server-에-등록된-Service-확인하기"><a href="#Eureka-Server-에-등록된-Service-확인하기" class="headerlink" title="Eureka Server 에 등록된 Service 확인하기"></a>Eureka Server 에 등록된 Service 확인하기</h2><p><img src="/images/springboot/msa/eureka-server-client.png" alt="Service 등록 후 Dashborad"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Cloud/">Spring Cloud</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Cloud/Service-Discovery/">Service Discovery</category>
      
      
      <category domain="https://ckck803.github.io/tags/Spring-Boot/">Spring Boot</category>
      
      
      <comments>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-client/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Cloud - Service Discovery Server (Eureka)</title>
      <link>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-server/</link>
      <guid>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-server/</guid>
      <pubDate>Thu, 29 Jun 2023 17:31:31 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/06/30/springboot/spring-cloud/service-discovery/s</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-client/" title="Spring Cloud - Eureka 에 Service 등록하기">Spring Cloud - Eureka 에 Service 등록하기</a></li><li><a href="/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-server/" title="Spring Cloud - Service Discovery Server (Eureka)">Spring Cloud - Service Discovery Server (Eureka)</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/">https://cloud.spring.io/spring-cloud-netflix/reference/html/</a></li><li><a href="https://coe.gitbook.io/guide/service-discovery/eureka">https://coe.gitbook.io/guide/service-discovery/eureka</a></li></ul><h2 id="사용하는-Spring-Cloud-버전"><a href="#사용하는-Spring-Cloud-버전" class="headerlink" title="사용하는 Spring Cloud 버전"></a>사용하는 Spring Cloud 버전</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;org.springframework.boot&#x27;</span> version <span class="string">&#x27;2.4.5&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;io.spring.dependency-management&#x27;</span> version <span class="string">&#x27;1.0.11.RELEASE&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;java&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">group = <span class="string">&#x27;com.example&#x27;</span></span><br><span class="line">version = <span class="string">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class="line">sourceCompatibility = <span class="string">&#x27;11&#x27;</span></span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ext &#123;</span><br><span class="line">    set(<span class="string">&#x27;springCloudVersion&#x27;</span>, <span class="string">&quot;2020.0.2&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    testImplementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencyManagement &#123;</span><br><span class="line">    imports &#123;</span><br><span class="line">        mavenBom <span class="string">&quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test &#123;</span><br><span class="line">    useJUnitPlatform()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Spring-Cloud-Eureka"><a href="#Spring-Cloud-Eureka" class="headerlink" title="Spring Cloud Eureka"></a>Spring Cloud Eureka</h2><p>MSA (Micro Service Architecture) 에서는 각 서비스를 관리하기 위해서 Service Discovery Server 가 필요합니다. Spring Cloud 에서는 Service Discovery 를 위해 Eureka 를 사용한다.</p><h2 id="Discovery-Server-Eureka"><a href="#Discovery-Server-Eureka" class="headerlink" title="Discovery Server (Eureka)"></a>Discovery Server (Eureka)</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-server&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="EnableEurekaServer"><a href="#EnableEurekaServer" class="headerlink" title="@EnableEurekaServer"></a>@EnableEurekaServer</h2><p>Discovery Server 로 작동하기 위해 <code>@EnableEurekaServer</code> 어노테이션을 추가하여 Eureka Server 를 구성합니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiscoveryServiceApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DiscoveryServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Properties-설정-추가"><a href="#Properties-설정-추가" class="headerlink" title="Properties 설정 추가"></a>Properties 설정 추가</h2><ul><li><code>eureka.client.register-with-eureka</code><ul><li>레지스트리 서버에 본인을 등록할지 여부를 설정합니다.</li></ul></li><li><code>eureka.client.fetch-registry</code><ul><li>레지스트리 정보를 가져올지 여부를 설정합니다.</li></ul></li></ul><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">discoveryservice</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span> </span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><img src="/images/springboot/msa/eureka-server.png" alt="Eureka Server Dashboard"></p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Cloud/">Spring Cloud</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Cloud/Service-Discovery/">Service Discovery</category>
      
      
      <category domain="https://ckck803.github.io/tags/Spring-Boot/">Spring Boot</category>
      
      
      <comments>https://ckck803.github.io/2023/06/30/springboot/spring-cloud/service-discovery/spring-cloud-eureka-server/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - 배치 설정 (application.properties)</title>
      <link>https://ckck803.github.io/2023/06/28/springboot/spring-batch/spring-batch-batch-properties/</link>
      <guid>https://ckck803.github.io/2023/06/28/springboot/spring-batch/spring-batch-batch-properties/</guid>
      <pubDate>Wed, 28 Jun 2023 06:25:35 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/spring-batch/spring-batch.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;배치-잡의-실행-여부를-설정&quot;&gt;&lt;a href=&quot;#배치-잡의-실행-여부를-설정&quot; class=&quot;headerlink&quot; title=&quot;배치 잡의</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/spring-batch/spring-batch.jpg"></p><h2 id="배치-잡의-실행-여부를-설정"><a href="#배치-잡의-실행-여부를-설정" class="headerlink" title="배치 잡의 실행 여부를 설정"></a>배치 잡의 실행 여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Spring Boot 가 자동으로 실행시키는 Batch Job 을 실행시키도록 한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.enabled:</span> <span class="literal">true</span> <span class="comment"># default</span></span><br><span class="line"><span class="comment"># Spring Boot 가 자동으로 실행시키는 Batch Job 을 실행하지 않도록 한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡의-재시작-여부를-설정"><a href="#배치-잡의-재시작-여부를-설정" class="headerlink" title="배치 잡의 재시작 여부를 설정"></a>배치 잡의 재시작 여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 기본이 true, 재시작을 허용한다.</span></span><br><span class="line"><span class="attr">spring.batch.job.restartable:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># 재시작을 허용하지 않는다</span></span><br><span class="line"><span class="attr">spring.batch.job.restartable:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="실행할-배치-잡의-이름을-지정"><a href="#실행할-배치-잡의-이름을-지정" class="headerlink" title="실행할 배치 잡의 이름을 지정"></a>실행할 배치 잡의 이름을 지정</h2><p>스프링 배치는 실행시 기본적으로 모든 Job 을 실행시킵니다. <code>spring.batch.job.names</code> 를 이용해 지정 Job 만 실행하도록 설정할 수 있습니다. </p><p>프로그램 실행시 특정 Job 을 전달받아 실행시키고 싶을 경우 <code>spring.batch.job.names: $&#123;job.name:NONE&#125;</code> 로 설정하면 외부에서 주입받은 Job 이름을 이용해 실행시킬 수 있습니다. 만일 전달받은 값이 없으면 아무 Job 도 실행시키지 않습니다.</p><p><code>:NONE</code> 은 프로퍼티 표현 중 하나로 전달받은 값이 없을 경우 NONE 으로 대체한다는 의미이다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Hard Coding 방식</span></span><br><span class="line"><span class="attr">spring.batch.job.names:</span> <span class="string">springJob1</span></span><br><span class="line"><span class="comment"># Binding 을 사용한 방식</span></span><br><span class="line"><span class="attr">spring.batch.job.names:</span> <span class="string">$&#123;job.name:NONE&#125;</span> </span><br></pre></td></tr></table></figure><h4 id="실행시킬-Job-을-지정하는-방법"><a href="#실행시킬-Job-을-지정하는-방법" class="headerlink" title="실행시킬 Job 을 지정하는 방법"></a>실행시킬 Job 을 지정하는 방법</h4><ul><li>어플리케이션 실행시 Program arguments 로 Job 이름 입력한다.<ul><li><code>--job.name=helloJob</code></li></ul></li><li>하나 이상의 Job 을 실행할 경우 쉼표로 구분해서 입력 한다.<ul><li><code>--job.name=helloJob,simpleJob</code></li></ul></li></ul><p>어플리케이션 실행시점에 Argument 로 넘겨서 Binding 되도록 한다.</p><p><image src=/images/spring-batch/ch4/job_name_properties.png width=750><span class="caption">인텔리제이에서 Program Argument 를 이용한 Job 실행</span></p><h2 id="배치-메타-데이터-저장을-위한-테이블-스키마-자동-생성여부를-설정"><a href="#배치-메타-데이터-저장을-위한-테이블-스키마-자동-생성여부를-설정" class="headerlink" title="배치 메타 데이터 저장을 위한 테이블 스키마 자동 생성여부를 설정"></a>배치 메타 데이터 저장을 위한 테이블 스키마 자동 생성여부를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">embedded</span> <span class="comment"># default</span></span><br><span class="line"><span class="attr">spring.batch.jdbc.initialize-schema:</span> <span class="string">never</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡에서-생성되는-메타-데이터-테이블-Prefix-를-설정"><a href="#배치-잡에서-생성되는-메타-데이터-테이블-Prefix-를-설정" class="headerlink" title="배치 잡에서 생성되는 메타 데이터 테이블 Prefix 를 설정"></a>배치 잡에서 생성되는 메타 데이터 테이블 Prefix 를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.batch.jdbc.table-prefix:</span>  <span class="string">DEMO</span></span><br></pre></td></tr></table></figure><h2 id="배치-잡에서-허용하는-실패-횟수를-설정"><a href="#배치-잡에서-허용하는-실패-횟수를-설정" class="headerlink" title="배치 잡에서 허용하는 실패 횟수를 설정"></a>배치 잡에서 허용하는 실패 횟수를 설정</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 배치 잡에서 허용하는 실패 횟수를 설정한다. default: 3</span></span><br><span class="line"><span class="attr">spring.batch.job.failures-allowed:</span> <span class="number">3</span> </span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/28/springboot/spring-batch/spring-batch-batch-properties/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - ServiceAccount</title>
      <link>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/</link>
      <guid>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/</guid>
      <pubDate>Sun, 11 Jun 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;!-- ![](/images/k8s/helm/helm.png) --&gt;

&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<!-- ![](/images/k8s/helm/helm.png) --><p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/07/k8s/secret/" title="쿠버네티스 - Secret">쿠버네티스 - Secret</a></li><li><a href="/2023/05/07/k8s/configmap/" title="쿠버네티스 - ConfigMap">쿠버네티스 - ConfigMap</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="/2023/05/07/k8s/data_plane/" title="쿠버네티스 - Data Plane">쿠버네티스 - Data Plane</a></li><li><a href="/2023/05/07/k8s/control_plane/" title="쿠버네티스 - Control Plane">쿠버네티스 - Control Plane</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://findstar.pe.kr/2023/04/09/access-k8s-api-from-pod/">https://findstar.pe.kr/2023/04/09/access-k8s-api-from-pod/</a></li><li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</a></li><li><a href="https://kubernetes.io/ko/docs/reference/access-authn-authz/service-accounts-admin/">https://kubernetes.io/ko/docs/reference/access-authn-authz/service-accounts-admin/</a></li></ul><h2 id="ServiceAccount"><a href="#ServiceAccount" class="headerlink" title="ServiceAccount"></a>ServiceAccount</h2><blockquote><p>ServiceAccount 는 쿠버네티스 API 서버와 통신하고 클러스터 내의 다른 리소스에 접근하기 위한 인증 정보를 제공합니다.</p></blockquote><!-- ServiceAccount는 쿠버네티스 API 서버와 통신하고 클러스터 내의 다른 리소스에 접근하기 위한 인증 정보를 제공합니다.ServiceAccount 는 Pod 에서 클러스터를 조작하고 싶을 경우 kube-apiserver 에 접근이 가능하도록 권한을 부여하는 리소스입니다.일반적으로 쿠버네티스에서 애플리케이션은 Pod라는 단위로 실행됩니다. Pod 내부의 애플리케이션은 ServiceAccount를 사용하여 클러스터 내의 다른 리소스와 상호 작용할 수 있습니다. 각 Pod는 자체적으로 고유한 ServiceAccount를 가질 수 있으며, 이를 통해 해당 Pod의 애플리케이션이 클러스터 리소스에 접근할 수 있는 권한을 부여받을 수 있습니다.ServiceAccount는 클러스터 내에서 사용자 계정과 동일한 역할을 합니다. 즉, 각 ServiceAccount는 클러스터 내에서 고유한 식별자를 가지고 있으며, 해당 ServiceAccount에는 롤(Role) 또는 클러스터 롤(ClusterRole)이 할당될 수 있습니다. 롤 및 클러스터 롤은 애플리케이션에 대한 특정 작업(예: 리소스 생성, 수정, 삭제)을 수행할 수 있는 권한을 정의합니다.ServiceAccount는 Pod를 생성할 때 자동으로 생성되며, Pod의 spec에 ServiceAccount 이름을 명시하여 특정 ServiceAccount를 할당할 수 있습니다. 애플리케이션은 이 할당된 ServiceAccount를 사용하여 클러스터 내의 리소스에 접근하고 API 호출을 수행합니다. --><p>ServiceAccount 는 Pod 가 Kubernetes API Server 에 인증 하기 위한 Account 입니다. 때문에 Pod 를 생성할때 ServiceAccount 를 할당해야 하며 지정하지 않을 경우 <strong>default</strong> 가 자동으로 할당됩니다.</p><p>Rule 과 RuleBinding 을 이용해 ServiceAccount 에 권한을 부여함으로써 Pod 가 다른 리소스에 접근할 수 있게 해줍니다.</p><p>ServiceAccount 는 Namespace 단위로 생성되는 리소스며 다른 Namespace 에서 정의된 ServiceAccount 를 사용할 수 없습니다.</p><h2 id="ServiceAccount-생성하기"><a href="#ServiceAccount-생성하기" class="headerlink" title="ServiceAccount 생성하기"></a>ServiceAccount 생성하기</h2><p>매니페스트 내 <code>kind: ServiceAccount</code> 를 사용하여 ServiceAccount를 생성할 수 있습니다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">ServiceAccount</span> <span class="string">에</span> <span class="string">대한</span> <span class="string">설명</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">이름&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">를</span> <span class="string">사용할</span> <span class="string">Namespace&gt;</span> </span><br></pre></td></tr></table></figure><h2 id="Token-생성"><a href="#Token-생성" class="headerlink" title="Token 생성"></a>Token 생성</h2><p>v1.22 이전 버전의 쿠버네티스 버전은 쿠버네티스 API에 액세스하기 위한 장기 자격 증명을 자동으로 생성했다. 이 이전 메커니즘은 실행 중인 파드에 마운트할 수 있는 토큰 시크릿을 생성하는 것을 기반으로 했다. 쿠버네티스 v1.27을 포함한 최신 버전에서는, API 자격 증명이 토큰리퀘스트 API를 사용하여 직접 획득되고, 예상 볼륨을 사용하여 파드에 마운트된다. 이 방법을 사용하여 획득한 토큰은 수명이 제한되어 있으며, 마운트된 파드가 삭제되면 자동으로 무효화된다.</p><p>예를 들어 만료되지 않는 토큰이 필요한 경우 서비스 어카운트 토큰 시크릿을 수동으로 생성할 수 있다. 그러나 대신 TokenRequest 서브리소스를 사용하여 API에 액세스하기 위한 토큰을 얻는 것을 권장한다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create token &lt;ServiceAccount Name&gt;</span><br></pre></td></tr></table></figure><h2 id="Secret-생성"><a href="#Secret-생성" class="headerlink" title="Secret 생성"></a>Secret 생성</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Secret</span> <span class="string">Name&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/service-account.name:</span> <span class="string">&lt;ServiceAccount</span> <span class="string">Name&gt;</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">kubernetes.io/service-account-token</span></span><br></pre></td></tr></table></figure><h2 id="Rule"><a href="#Rule" class="headerlink" title="Rule"></a>Rule</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubectl-prometheus-alertmanager-role</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">apiGroups:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">apps</span></span><br><span class="line">  <span class="attr">resourceNames:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">prometheus-alertmanager</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">alertmanager</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">statefulsets</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">statefulsets/scale</span></span><br><span class="line">  <span class="attr">verbs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">get</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">patch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">list</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">watch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">update</span></span><br></pre></td></tr></table></figure><h2 id="RoleBinding"><a href="#RoleBinding" class="headerlink" title="RoleBinding"></a>RoleBinding</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">RoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubectl-prometheus-alertmanager-rolebinding</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Role</span> <span class="string">Name&gt;</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&lt;Service</span> <span class="string">Account</span> <span class="string">Name&gt;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">mbc-add-dev</span></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Config/">Config</category>
      
      
      
      <comments>https://ckck803.github.io/2023/06/11/k8s/config/ServiceAccount/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Istio - istioctl2</title>
      <link>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/</link>
      <guid>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/</guid>
      <pubDate>Thu, 25 May 2023 23:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/istio/istio.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/istio/istio.jpg"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/08/k8s/istio/istio-locality_load_balacing/" title="Istio - Locality Load Balancing (지역 로드 밸런싱)">Istio - Locality Load Balancing (지역 로드 밸런싱)</a></li><li><a href="/2023/05/08/k8s/istio/istio-injection/" title="Istio - Sidecar Injection">Istio - Sidecar Injection</a></li><li><a href="/2023/05/08/k8s/istio/istio-istioctl/" title="Istio - istioctl">Istio - istioctl</a></li><li><a href="/2023/05/08/k8s/istio/istio/" title="Istio 란?">Istio 란?</a></li></ul><h2 id="공식-홈페이지"><a href="#공식-홈페이지" class="headerlink" title="공식 홈페이지"></a>공식 홈페이지</h2><ul><li><a href="https://istio.io/latest/docs/setup/getting-started/">https://istio.io/latest/docs/setup/getting-started/</a></li></ul><h2 id="istioctl-설치"><a href="#istioctl-설치" class="headerlink" title="istioctl 설치"></a>istioctl 설치</h2><p>Mac 을 사용하는 경우 HomeBrew 를 이용해 istioctl 을 설치할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">brew install istioctl</span><br></pre></td></tr></table></figure><p>다른 OS 를 사용하거나 특정 버전의 Istio 를 사용하고 싶은 경우 다음과 같이 Istio 버전을 Setting 한 후 해당 버전을 내려받아 사용할 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ISTIO_VERSION=1.14.5</span><br><span class="line">curl -L https://istio.io/downloadIstio | ISTIO_VERSION=<span class="variable">$ISTIO_VERSION</span> TARGET_ARCH=x86_64 sh -</span><br></pre></td></tr></table></figure><h2 id="Istio-Profile-설치"><a href="#Istio-Profile-설치" class="headerlink" title="Istio Profile 설치"></a>Istio Profile 설치</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">istioctl install --<span class="built_in">set</span> profile=demo --<span class="built_in">set</span> hub=gcr.io/istio-release</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/istio-demo2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f samples/addons</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/install-addons.png"></p><h4 id="설치된-Istio-Resource"><a href="#설치된-Istio-Resource" class="headerlink" title="설치된 Istio Resource"></a>설치된 Istio Resource</h4><p><img src="/images/k8s/istio/tutorial/addons-all-resources.png"></p><h2 id="Kiali"><a href="#Kiali" class="headerlink" title="Kiali"></a>Kiali</h2><p>외부에서 접근이 가능하도록 Kiali Service 를 ClusterIP 에서 LoadBalancer 로 변경합니다</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch svc kiali -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/kiali-svc-patch.png) --><p>LoadBalancer 로 변경 되면서 <code>EXTERNAL-IP</code> 가 추가된 것을 확인할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/k9s-kiali-svc.png" alt="Kiali Service 의 EXTERNAL-IP 확인"></p><p>EXTERNAL-IP 를 이용해 접근하면 Kiali Dashboard 로 접근할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-kiali-dashboard2.png" alt="Kiali Dashboard"></p><h2 id="Jaeger"><a href="#Jaeger" class="headerlink" title="Jaeger"></a>Jaeger</h2><p>외부에서 접근이 가능하도록 Jaeger Service 를 ClusterIP 에서 LoadBalancer 로 변경합니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch svc tracing -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/jaeger-svc-patch.png) --><p>LoadBalancer 로 변경 되면서 <code>EXTERNAL-IP</code> 가 추가된 것을 확인할 수 있다.</p><p><img src="/images/k8s/istio/tutorial/k9s-jaeger-svc.png" alt="Jaeger Service 의 EXTERNAL-IP 확인"></p><p>EXTERNAL-IP 를 이용해 접근하면 Jaeger Dashboard 로 접근할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-jaeger-dashboard.png" alt="Jaeger Dashboard"></p><h2 id="Sidecar-Injection-방법"><a href="#Sidecar-Injection-방법" class="headerlink" title="Sidecar Injection 방법"></a>Sidecar Injection 방법</h2><ul><li><em><code>Istioctl kube-inject Command</code> 를 이용하는 방법</em></li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f Deployment.yml)</span><br></pre></td></tr></table></figure><ul><li><em>Namespace 에 <code>istio-injection</code> 을 enabled 로 설정하는 방법</em></li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl label namespace tutorial istio-injection=enabled</span><br></pre></td></tr></table></figure><h2 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create namespace tutorial</span><br></pre></td></tr></table></figure><p>Deployment 를 설치 할때 <code>istioctl kube-inject</code> 명령어를 통해 Istio Container 가 Pod 내에 설치되도록 설정합니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f customer/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f customer/kubernetes/Service.yml -n tutorial</span><br></pre></td></tr></table></figure><p>Pod 가 생성될때 내부에 Istio Container 가 생성된 것을 확인할 수 있습니다.</p><p><img src="/images/k8s/istio/tutorial/istio-customer.png" alt="customer Pod 에 설치된 Container 목록"></p><h4 id="Istio-Gateway-설치-및-Customer-서비스-라우팅-VirtualService-설정"><a href="#Istio-Gateway-설치-및-Customer-서비스-라우팅-VirtualService-설정" class="headerlink" title="Istio Gateway 설치 및 Customer 서비스 라우팅(VirtualService) 설정"></a>Istio Gateway 설치 및 Customer 서비스 라우팅(VirtualService) 설정</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: Gateway</span><br><span class="line">metadata:</span><br><span class="line">  name: customer-gateway</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    istio: ingressgateway <span class="comment"># use istio default controller</span></span><br><span class="line">  servers:</span><br><span class="line">  - port:</span><br><span class="line">      number: 80</span><br><span class="line">      name: http</span><br><span class="line">      protocol: HTTP</span><br><span class="line">    hosts:</span><br><span class="line">    - <span class="string">&quot;*&quot;</span></span><br><span class="line">---</span><br><span class="line">apiVersion: networking.istio.io/v1alpha3</span><br><span class="line">kind: VirtualService</span><br><span class="line">metadata:</span><br><span class="line">  name: customer-gateway</span><br><span class="line">spec:</span><br><span class="line">  hosts:</span><br><span class="line">  - <span class="string">&quot;*&quot;</span></span><br><span class="line">  gateways:</span><br><span class="line">  - customer-gateway</span><br><span class="line">  http:</span><br><span class="line">  - match:</span><br><span class="line">    - uri:</span><br><span class="line">        prefix: /customer</span><br><span class="line">    rewrite:</span><br><span class="line">      uri: /</span><br><span class="line">    route:</span><br><span class="line">    - destination:</span><br><span class="line">        host: customer</span><br><span class="line">        port:</span><br><span class="line">          number: 8080</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f customer/kubernetes/Gateway.yml -n tutorial</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f preference/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f preference/kubernetes/Service.yml -n tutorial</span><br><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f recommendation/kubernetes/Deployment.yml) -n tutorial</span><br><span class="line">kubectl create -f recommendation/kubernetes/Service.yml -n tutorial</span><br></pre></td></tr></table></figure><h2 id="Istio-Traffic-Routing"><a href="#Istio-Traffic-Routing" class="headerlink" title="Istio - Traffic Routing"></a>Istio - Traffic Routing</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f &lt;(istioctl kube-inject -f recommendation/kubernetes/Deployment-v2.yml) -n tutorial</span><br></pre></td></tr></table></figure><!-- ![](/images/k8s/istio/tutorial/deploy-2.png) --><p><img src="/images/k8s/istio/tutorial/deploy-v2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl scale --replicas=2 deployment/recommendation-v2 -n tutorial</span><br><span class="line">kubectl get po -n tutorial</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/scale-2.png"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl get VirtualService -n tutorial -o yaml</span><br><span class="line">kubectl get DestinationRule -n tutorial -o yaml</span><br></pre></td></tr></table></figure><h2 id="Istio-Timeout-Retry"><a href="#Istio-Timeout-Retry" class="headerlink" title="Istio Timeout &amp; Retry"></a>Istio Timeout &amp; Retry</h2><h4 id="Timeout-설정"><a href="#Timeout-설정" class="headerlink" title="Timeout 설정"></a>Timeout 설정</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">    apiVersion: networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="string">    kind: VirtualService</span></span><br><span class="line"><span class="string">    metadata:</span></span><br><span class="line"><span class="string">      name: vs-order-network-rule</span></span><br><span class="line"><span class="string">      namespace: tutorial</span></span><br><span class="line"><span class="string">    spec:</span></span><br><span class="line"><span class="string">      hosts:</span></span><br><span class="line"><span class="string">      - order</span></span><br><span class="line"><span class="string">      http:</span></span><br><span class="line"><span class="string">      - route:</span></span><br><span class="line"><span class="string">        - destination:</span></span><br><span class="line"><span class="string">            host: order</span></span><br><span class="line"><span class="string">        timeout: 3s</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h4 id="Siege-생성"><a href="#Siege-생성" class="headerlink" title="Siege 생성"></a>Siege 생성</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">apiVersion: v1</span></span><br><span class="line"><span class="string">kind: Pod</span></span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="string">  name: siege</span></span><br><span class="line"><span class="string">  namespace: tutorial</span></span><br><span class="line"><span class="string">spec:</span></span><br><span class="line"><span class="string">  containers:</span></span><br><span class="line"><span class="string">  - name: siege</span></span><br><span class="line"><span class="string">    image: apexacme/siege-nginx</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it siege -c siege -n tutorial -- /bin/bash</span><br><span class="line">siege -c1 -t2S -v --content-type <span class="string">&quot;application/json&quot;</span> <span class="string">&#x27;http://order:8080/orders POST &#123;&quot;productId&quot;: &quot;1001&quot;, &quot;qty&quot;:5&#125;&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">siege -c30 -t20S -v --content-type <span class="string">&quot;application/json&quot;</span> <span class="string">&#x27;http://order:8080/orders POST &#123;&quot;productId&quot;: &quot;1001&quot;, &quot;qty&quot;:5&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/siege-kiali.png"></p><h4 id="Order-서비스에-‘Retry’-Rule-추가"><a href="#Order-서비스에-‘Retry’-Rule-추가" class="headerlink" title="Order 서비스에 ‘Retry’ Rule 추가"></a>Order 서비스에 ‘Retry’ Rule 추가</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl apply -f - &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">  apiVersion: networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="string">  kind: VirtualService</span></span><br><span class="line"><span class="string">  metadata:</span></span><br><span class="line"><span class="string">    name: vs-order-network-rule</span></span><br><span class="line"><span class="string">    namespace: tutorial</span></span><br><span class="line"><span class="string">  spec:</span></span><br><span class="line"><span class="string">    hosts:</span></span><br><span class="line"><span class="string">    - order</span></span><br><span class="line"><span class="string">    http:</span></span><br><span class="line"><span class="string">    - route:</span></span><br><span class="line"><span class="string">      - destination:</span></span><br><span class="line"><span class="string">          host: order</span></span><br><span class="line"><span class="string">      timeout: 3s</span></span><br><span class="line"><span class="string">      retries:</span></span><br><span class="line"><span class="string">        attempts: 3</span></span><br><span class="line"><span class="string">        perTryTimeout: 2s</span></span><br><span class="line"><span class="string">        retryOn: 5xx,retriable-4xx,gateway-error,connect-failure,refused-stream</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">&quot;Ingress&quot;</span></span><br><span class="line"><span class="attr">metadata:</span> </span><br><span class="line">  <span class="attr">name:</span> <span class="string">&quot;shopping-ingress&quot;</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">&quot;istio-system&quot;</span>  </span><br><span class="line">  <span class="attr">annotations:</span> </span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/ssl-redirect:</span> <span class="string">&quot;false&quot;</span></span><br><span class="line">    <span class="attr">ingressclass.kubernetes.io/is-default-class:</span> <span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="attr">spec:</span> </span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;kiali.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">kiali</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">20001</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;prom.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">prometheus</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">9090</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;gra.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">grafana</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">3000</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">&quot;tracing.service.com&quot;</span></span><br><span class="line">      <span class="attr">http:</span> </span><br><span class="line">        <span class="attr">paths:</span> </span><br><span class="line">          <span class="bullet">-</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span> </span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">tracing</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><h2 id="Prometheus-Grafana기반-K8s-통합-모니터링"><a href="#Prometheus-Grafana기반-K8s-통합-모니터링" class="headerlink" title="Prometheus&#x2F;Grafana기반 K8s 통합 모니터링"></a>Prometheus&#x2F;Grafana기반 K8s 통합 모니터링</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl create ns shop</span><br><span class="line">kubectl label namespace shop istio-injection=enabled</span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/order-liveness.yaml -n shop</span><br><span class="line">kubectl expose deploy order --port=8080 -n shop</span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/delivery-rediness-v1.yaml -n shop</span><br><span class="line">kubectl expose deploy delivery --port=8080 -n shop</span><br><span class="line"><span class="comment"># Client Pod deploy</span></span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/acmexii/demo/master/edu/siege-pod.yaml -n shop</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch service/prometheus -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/istio/tutorial/prometheus-dashboard.png" alt="Prometheus Dashboard"></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl patch service/grafana -n istio-system -p <span class="string">&#x27;&#123;&quot;spec&quot;: &#123;&quot;type&quot;: &quot;LoadBalancer&quot;&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/spring-framework/grafana-dashboard.png" alt="Grafana Dashboard"></p><h2 id="Istio-삭제-방법"><a href="#Istio-삭제-방법" class="headerlink" title="Istio 삭제 방법"></a>Istio 삭제 방법</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> istio-<span class="variable">$ISTIO_VERSION</span></span><br><span class="line">kubectl delete -f samples/addons</span><br><span class="line">istioctl manifest generate --<span class="built_in">set</span> profile=demo | kubectl delete --ignore-not-found=<span class="literal">true</span> -f -</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl delete namespace istio-system</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Istio/">Istio</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/26/k8s/istio/istio-istioctl2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - CustomResource</title>
      <link>https://ckck803.github.io/2023/05/18/k8s/CustomResource/CustomResource/</link>
      <guid>https://ckck803.github.io/2023/05/18/k8s/CustomResource/CustomResource/</guid>
      <pubDate>Thu, 18 May 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;참고&quot;&gt;&lt;a href=&quot;#참고&quot; class=&quot;headerlink&quot; title=&quot;참고&quot;&gt;&lt;/a&gt;참고&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://frozenpo</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/k8s.png"></p><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://frozenpond.tistory.com/111">https://frozenpond.tistory.com/111</a></li></ul><h2 id="CustomResource"><a href="#CustomResource" class="headerlink" title="CustomResource"></a>CustomResource</h2><p>Custom Resource는 쿠버네티스에서 사용자가 정의한 리소스를 나타냅니다. </p><p>이는 일반적으로 클러스터 내에 존재하지 않는 기본 리소스의 새로운 종류를 정의하고, 이를 통해 사용자의 애플리케이션에 특화된 동작을 수행할 수 있도록 합니다. Custom Resource 는 클러스터 상태의 일부로서 존재하며, 일반적인 리소스와 동일한 방식으로 쿠버네티스 API를 통해 작동합니다. 예를 들어, 사용자는 Custom Resource 를 생성, 조회, 수정 및 삭제할 수 있습니다.</p><p>Custom Resource 를 사용하기 위해 먼저 Custom Resource Definition(CRD) 을 정의해야 합니다. CRD는 Custom Resource 의 스키마를 설명하는 쿠버네티스 API 개체입니다. 이를 통해 Custom Resource 의 구조, 필드 및 기타 특성을 정의할 수 있습니다. CRD는 일종의 템플릿으로서, Custom Resource 의 정의를 기반으로 생성됩니다. CRD를 생성하면 쿠버네티스 API 서버가 새로운 Custom Resource 타입을 이해하고 처리할 수 있게 됩니다.</p><p>Custom Resource Definition 을 작성한 후, 사용자는 해당 정의를 사용하여 Custom Resource 인스턴스를 생성하고 관리할 수 있습니다. Custom Resource 인스턴스는 일반적으로 YAML 또는 JSON 형식으로 정의되며, 클러스터에 배포됩니다. 이후 Custom Resource 는 클러스터 내에서 다른 리소스와 유사하게 다룰 수 있으며, 사용자는 쿠버네티스 API를 사용하여 Custom Resource 를 조작할 수 있습니다.</p><p>Custom Resource 와 Custom Resource Definition 은 쿠버네티스의 확장성과 유연성을 높여줍니다. 사용자는 쿠버네티스 API를 통해 고유한 리소스 유형을 정의하고 제어할 수 있으며, 이를 통해 자신의 애플리케이션을 더욱 쉽게 관리할 수 있습니다.</p><p><img src="/images/k8s/helm-delete-crd.png"></p><p><img src="/images/k8s/helm-install-crd.png"></p><h2 id="CustomResourceDefinition"><a href="#CustomResourceDefinition" class="headerlink" title="CustomResourceDefinition"></a>CustomResourceDefinition</h2><p><code>apiVersion: apiextensions.k8s.io/v1</code> 를 이용해 CustomResourceDefinition 을 생성할 수 있다.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apiextensions.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">CustomResourceDefinition</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="comment"># name must match the spec fields below, and be in the form: &lt;plural&gt;.&lt;group&gt;</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">crontabs.stable.example.com</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># group name to use for REST API: /apis/&lt;group&gt;/&lt;version&gt;</span></span><br><span class="line">  <span class="attr">group:</span> <span class="string">stable.example.com</span></span><br><span class="line">  <span class="comment"># list of versions supported by this CustomResourceDefinition</span></span><br><span class="line">  <span class="attr">versions:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">v1</span></span><br><span class="line">      <span class="comment"># Each version can be enabled/disabled by Served flag.</span></span><br><span class="line">      <span class="attr">served:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment"># One and only one version must be marked as the storage version.</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">schema:</span></span><br><span class="line">        <span class="attr">openAPIV3Schema:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">object</span></span><br><span class="line">          <span class="attr">properties:</span></span><br><span class="line">            <span class="attr">spec:</span></span><br><span class="line">              <span class="attr">type:</span> <span class="string">object</span></span><br><span class="line">              <span class="attr">properties:</span></span><br><span class="line">                <span class="attr">cronSpec:</span></span><br><span class="line">                  <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">                <span class="attr">image:</span></span><br><span class="line">                  <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">                <span class="attr">replicas:</span></span><br><span class="line">                  <span class="attr">type:</span> <span class="string">integer</span></span><br><span class="line">  <span class="comment"># either Namespaced or Cluster</span></span><br><span class="line">  <span class="attr">scope:</span> <span class="string">Namespaced</span></span><br><span class="line">  <span class="attr">names:</span></span><br><span class="line">    <span class="comment"># plural name to be used in the URL: /apis/&lt;group&gt;/&lt;version&gt;/&lt;plural&gt;</span></span><br><span class="line">    <span class="attr">plural:</span> <span class="string">crontabs</span></span><br><span class="line">    <span class="comment"># singular name to be used as an alias on the CLI and for display</span></span><br><span class="line">    <span class="attr">singular:</span> <span class="string">crontab</span></span><br><span class="line">    <span class="comment"># kind is normally the CamelCased singular type. Your resource manifests use this.</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">CronTab</span></span><br><span class="line">    <span class="comment"># shortNames allow shorter string to match your resource on the CLI</span></span><br><span class="line">    <span class="attr">shortNames:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ct</span></span><br></pre></td></tr></table></figure><h2 id="Kubernetes-Operator"><a href="#Kubernetes-Operator" class="headerlink" title="Kubernetes Operator"></a>Kubernetes Operator</h2>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Custom/">Custom</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/18/k8s/CustomResource/CustomResource/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - CA (Cluster Autoscaler)</title>
      <link>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/</link>
      <guid>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/</guid>
      <pubDate>Thu, 18 May 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05/18/k8s/</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/18/k8s/deployment/hpa/" title="쿠버네티스 - HPA (Horizontal Pod Autoscaler)">쿠버네티스 - HPA (Horizontal Pod Autoscaler)</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h2>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Autoscaler/">Autoscaler</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/18/k8s/autoscaler/ca/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - VPA (Vertical Pod Autoscaler)</title>
      <link>https://ckck803.github.io/2023/05/18/k8s/autoscaler/vpa/</link>
      <guid>https://ckck803.github.io/2023/05/18/k8s/autoscaler/vpa/</guid>
      <pubDate>Wed, 17 May 2023 22:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05/18/k8s/</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/18/k8s/deployment/hpa/" title="쿠버네티스 - HPA (Horizontal Pod Autoscaler)">쿠버네티스 - HPA (Horizontal Pod Autoscaler)</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="VPA"><a href="#VPA" class="headerlink" title="VPA"></a>VPA</h2>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Autoscaler/">Autoscaler</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/18/k8s/autoscaler/vpa/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - HPA (Horizontal Pod Autoscaler)</title>
      <link>https://ckck803.github.io/2023/05/18/k8s/autoscaler/hpa/</link>
      <guid>https://ckck803.github.io/2023/05/18/k8s/autoscaler/hpa/</guid>
      <pubDate>Wed, 17 May 2023 21:31:46 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;목차&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2023/05/18/k8s/</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/18/k8s/autoscaler/vpa/" title="쿠버네티스 - VPA (Vertical Pod Autoscaler)">쿠버네티스 - VPA (Vertical Pod Autoscaler)</a></li><li><a href="/2023/05/18/k8s/autoscaler/hpa/" title="쿠버네티스 - HPA (Horizontal Pod Autoscaler)">쿠버네티스 - HPA (Horizontal Pod Autoscaler)</a></li></ul><h2 id="HPA"><a href="#HPA" class="headerlink" title="HPA"></a>HPA</h2><p>HPA (Horizontal Pod Autoscaler)는 Kubernetes 클러스터에서 자동으로 파드 수를 조정하는 기능입니다. HPA는 애플리케이션의 수요에 따라 파드의 수를 스케일 업 또는 스케일 다운하여 애플리케이션의 가용성과 성능을 유지하는 데 도움이 됩니다.</p><p>HPA는 리소스 사용량을 기반으로 파드의 수를 동적으로 조정합니다. 일반적으로 CPU 사용률 또는 커스텀 메트릭을 기반으로 합니다. HPA는 설정된 임계값과 현재 리소스 사용량을 비교하여 파드 수를 조정합니다.</p><p>HPA를 설정하려면 다음 단계를 수행해야 합니다:</p><ol><li>HPA를 적용할 리소스를 선택합니다. 대부분의 경우 Deployment 또는 ReplicaSet과 같은 컨트롤러 리소스를 선택합니다.</li><li>HPA 정의를 작성합니다. HPA 정의에는 스케일링 대상 리소스, 스케일링 조건, 스케일링 조정량 등이 포함됩니다. 예를 들어, CPU 사용률이 80%를 초과하면 파드 수를 2배로 스케일 업할 수 있도록 설정할 수 있습니다.</li><li>HPA를 적용합니다. HPA를 적용하면 Kubernetes는 지정된 간격으로 리소스 사용량을 확인하고 스케일링 결정을 내립니다.</li></ol><p>HPA는 애플리케이션의 부하가 증가하면 파드 수를 자동으로 늘리고, 부하가 감소하면 파드 수를 줄여 리소스를 효율적으로 관리합니다. 이를 통해 애플리케이션의 가용성과 성능을 최적화할 수 있습니다.</p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Autoscaler/">Autoscaler</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/18/k8s/autoscaler/hpa/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>MySQL - 테이블 스키마 조회</title>
      <link>https://ckck803.github.io/2023/05/11/mysql/command/</link>
      <guid>https://ckck803.github.io/2023/05/11/mysql/command/</guid>
      <pubDate>Wed, 10 May 2023 16:16:13 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/database/mysql/MySQL.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Comment-조회&quot;&gt;&lt;a href=&quot;#Comment-조회&quot; class=&quot;headerlink&quot; title=&quot;Comment 조회&quot;&gt;&lt;/a&gt;Comm</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/database/mysql/MySQL.png"></p><h2 id="Comment-조회"><a href="#Comment-조회" class="headerlink" title="Comment 조회"></a>Comment 조회</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> COLUMN_NAME, COLUMN_COMMENT, IS_NULLABLE, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, COLUMN_TYPE </span><br><span class="line"><span class="keyword">from</span> information_schema.`COLUMNS` </span><br><span class="line"><span class="keyword">where</span> TABLE_NAME <span class="operator">=</span> <span class="string">&#x27;테이블명&#x27;</span></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Develop/">Develop</category>
      
      <category domain="https://ckck803.github.io/categories/Develop/MySQL/">MySQL</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/11/mysql/command/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - ItemStream</title>
      <link>https://ckck803.github.io/2023/05/10/springboot/spring-batch/chunk/spring-batch-ItemStream/</link>
      <guid>https://ckck803.github.io/2023/05/10/springboot/spring-batch/chunk/spring-batch-ItemStream/</guid>
      <pubDate>Wed, 10 May 2023 04:25:35 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;출처&quot;&gt;&lt;a href=&quot;#출처&quot; class=&quot;headerlink&quot; title=&quot;출처&quot;&gt;&lt;/a&gt;출처&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;해당 포스트는 정수원 강사님의 &lt;a href=&quot;https://www.inflearn.com/course/%EC%8A</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="출처"><a href="#출처" class="headerlink" title="출처"></a>출처</h2><ul><li>해당 포스트는 정수원 강사님의 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98/dashboard">스프링 배치 - Spring Boot 기반으로 개발하는 Spring Batch</a> 강의를 바탕으로 작성 됐습니다.</li></ul><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/" title="Spring Batch - ItemWriter">Spring Batch - ItemWriter</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/" title="Spring Batch - ItemProcessor">Spring Batch - ItemProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/" title="Spring Batch - ItemReader">Spring Batch - ItemReader</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/" title="Spring Batch - ChunkProvider 와 ChunkProcessor">Spring Batch - ChunkProvider 와 ChunkProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkOrientedTasklet/" title="Spring Batch - ChunkOrientedTasklet">Spring Batch - ChunkOrientedTasklet</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-Chunk/" title="Spring Batch - Chunk 기반 Step">Spring Batch - Chunk 기반 Step</a></li><li><a href="/2023/05/08/springboot/spring-batch/flow/spring-batch-24-FlowJob/" title="Spring Batch - 24. FlowJob">Spring Batch - 24. FlowJob</a></li><li><a href="#">Post not found: springboot/spring-batch/tasklet/spring-batch-23-JobStep</a></li><li><a href="/2023/05/06/springboot/spring-batch/tasklet/spring-batch-22-Tasklet/" title="Spring Batch - 22. Tasklet 기반 Step">Spring Batch - 22. Tasklet 기반 Step</a></li><li><a href="/2023/05/04/springboot/spring-batch/tasklet/spring-batch-21-TaskletStep/" title="Spring Batch - 21. TaskletStep">Spring Batch - 21. TaskletStep</a></li><li><a href="/2023/05/04/springboot/spring-batch/step/spring-batch-20-StepBuilderFactory/" title="Spring Batch - 20. StepBuilderFactory 와 StepBuilder">Spring Batch - 20. StepBuilderFactory 와 StepBuilder</a></li><li><a href="/2023/05/03/springboot/spring-batch/job/spring-batch-19-JobIncrementer/" title="Spring Batch - 19. JobParameters 증가 JobParametersIncrementer">Spring Batch - 19. JobParameters 증가 JobParametersIncrementer</a></li><li><a href="/2023/04/06/springboot/spring-batch/job/spring-batch-18-preventRestart/" title="Spring Batch - 18. Job 의 재시작 방지 preventRestart">Spring Batch - 18. Job 의 재시작 방지 preventRestart</a></li><li><a href="/2023/04/05/springboot/spring-batch/job/spring-batch-17-JobParametersValidator/" title="Spring Batch - 17. JobParameters 검증 JobParametersValidator">Spring Batch - 17. JobParameters 검증 JobParametersValidator</a></li><li><a href="/2023/04/04/springboot/spring-batch/job/spring-batch-16-SimpleJob/" title="Spring Batch - 16. SimpleJob 와 SimpleJobLauncher">Spring Batch - 16. SimpleJob 와 SimpleJobLauncher</a></li><li><a href="/2023/04/02/springboot/spring-batch/job/spring-batch-15-JobBuilderFactory/" title="Spring Batch - 15. JobBuilderFactory &amp; JobBuilder">Spring Batch - 15. JobBuilderFactory &amp; JobBuilder</a></li></ul><h2 id="ItemStream"><a href="#ItemStream" class="headerlink" title="ItemStream"></a>ItemStream</h2><p>ItemStream 은 ItemReader 와 ItemWriter 처리 과정 중 상태를 저장하고 오류가 발생하면 해당 상태를 참조하여 실패한 곳에서 재시작 하도록 지원합니다. 리소스를 열고 닫아야 하며 입출력 장치 초기화 등의 작업을 해야 하는 경우 사용합니다.</p><p><img src="/images/spring-batch/ch7/itemStream.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ItemStream</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(ExecutionContext executionContext)</span> <span class="keyword">throws</span> ItemStreamException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(ExecutionContext executionContext)</span> <span class="keyword">throws</span> ItemStreamException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> ItemStreamException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/">Step</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/Chunk/">Chunk</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/10/springboot/spring-batch/chunk/spring-batch-ItemStream/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>쿠버네티스 - Secret</title>
      <link>https://ckck803.github.io/2023/05/10/k8s/config/secret/</link>
      <guid>https://ckck803.github.io/2023/05/10/k8s/config/secret/</guid>
      <pubDate>Wed, 10 May 2023 01:31:46 GMT</pubDate>
      
        
        
      <description>&lt;!-- ![](/images/k8s/helm/helm.png) --&gt;

&lt;p&gt;&lt;img src=&quot;/images/k8s/k8s.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;목차&quot;&gt;&lt;a href=&quot;#목차&quot; class=&quot;headerlink&quot; title=&quot;목차&quot;&gt;&lt;/a&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<!-- ![](/images/k8s/helm/helm.png) --><p><img src="/images/k8s/k8s.png"></p><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/07/k8s/secret/" title="쿠버네티스 - Secret">쿠버네티스 - Secret</a></li><li><a href="/2023/05/07/k8s/configmap/" title="쿠버네티스 - ConfigMap">쿠버네티스 - ConfigMap</a></li><li><a href="/2023/02/19/k8s/namespace/namespace/" title="쿠버네티스 - Namespace">쿠버네티스 - Namespace</a></li><li><a href="/2023/02/12/k8s/ingress/ingress/" title="쿠버네티스 - Ingress">쿠버네티스 - Ingress</a></li><li><a href="#">Post not found: k8s/deployment/deployment</a></li><li><a href="#">Post not found: k8s/replicaset/replicaset</a></li><li><a href="/2023/02/08/k8s/node/node/" title="쿠버네티스 - Node">쿠버네티스 - Node</a></li><li><a href="/2023/02/08/k8s/pod/pod/" title="쿠버네티스 - Pod">쿠버네티스 - Pod</a></li><li><a href="/2023/05/07/k8s/data_plane/" title="쿠버네티스 - Data Plane">쿠버네티스 - Data Plane</a></li><li><a href="/2023/05/07/k8s/control_plane/" title="쿠버네티스 - Control Plane">쿠버네티스 - Control Plane</a></li><li><a href="#">Post not found: k8s/k8s</a></li></ul><h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><blockquote><p>쿠버네티스(Secret)는 애플리케이션에서 민감한 데이터를 안전하게 저장하고 관리하기 위한 리소스</p></blockquote><p>Secret은 기본적으로 ConfigMap과 유사한 방식으로 동작하지만, 암호화된 형태로 데이터를 저장하여 더 높은 보안 수준을 제공합니다.</p><p>Secret은 애플리케이션에서 사용되는 비밀번호, API 토큰, 데이터베이스 자격증명 등과 같은 중요한 정보를 저장할 수 있습니다. 이러한 데이터는 애플리케이션의 컨테이너 이미지와 분리되어, 보안성을 유지하면서 애플리케이션을 배포하고 관리할 수 있습니다.</p><p>Secret은 Base64 인코딩을 사용하여 데이터를 인코딩하고, 쿠버네티스 클러스터 내부에서 저장됩니다. 이를 통해 데이터는 안전하게 저장되며, 컨테이너 내부에서 필요할 때만 디코딩하여 사용됩니다.</p><p>Secret은 YAML 또는 JSON 형식으로 정의되며, 쿠버네티스 클러스터에 생성 및 적용됩니다. Secret을 생성한 후에는 해당 Secret을 사용하려는 Pod의 컨테이너에 마운트하거나 환경 변수로 설정할 수 있습니다. 이렇게 하면 애플리케이션은 Secret에서 정의된 중요한 정보를 사용할 수 있습니다.</p><p>예를 들어, Secret에서 “db_password”라는 키에 대한 값으로 “mysecretpassword”를 설정하면, 애플리케이션은 이 값을 디코딩하여 데이터베이스 비밀번호로 사용할 수 있습니다. Secret은 ConfigMap과 마찬가지로 클러스터나 네임스페이스 수준에서 변경 및 관리할 수 있으므로, 변경된 비밀번호는 애플리케이션을 다시 시작하지 않고도 즉시 적용될 수 있습니다.</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">kubectl describe secret/db-user-pass</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">Name:</span>         <span class="string">db-user-pass</span></span><br><span class="line"><span class="attr">Namespace:</span>    <span class="string">default</span></span><br><span class="line"><span class="attr">Labels:</span>       <span class="string">&lt;none&gt;</span></span><br><span class="line"><span class="attr">Annotations:</span>  <span class="string">&lt;none&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Type:</span>  <span class="string">Opaque</span></span><br><span class="line"></span><br><span class="line"><span class="string">Data</span></span><br><span class="line"><span class="string">====</span></span><br><span class="line"><span class="attr">password.txt:</span>  <span class="number">7</span> <span class="string">bytes</span></span><br><span class="line"><span class="attr">username.txt:</span>  <span class="number">5</span> <span class="string">bytes</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ubectl get secret/db-user-pass -o yaml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">password.txt:</span> <span class="string">cTJ3M2U0cg==</span></span><br><span class="line">  <span class="attr">username.txt:</span> <span class="string">YWRtaW4=</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="string">&quot;2023-06-12T18:05:52Z&quot;</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">db-user-pass</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">resourceVersion:</span> <span class="string">&quot;54274&quot;</span></span><br><span class="line">  <span class="attr">uid:</span> <span class="string">45ac61f5-9c32-4d40-9823-d7c5edaba1ed</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">Opaque</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">alpine-env</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">alpine</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">alpine</span></span><br><span class="line">      <span class="attr">command:</span> [<span class="string">&quot;sleep&quot;</span>]</span><br><span class="line">      <span class="attr">args:</span> [<span class="string">&quot;100000&quot;</span>]</span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_USERNAME</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">db-user-pass</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">username.txt</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">db-user-pass</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">password.txt</span></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/">Kubernetes</category>
      
      <category domain="https://ckck803.github.io/categories/Kubernetes/Config/">Config</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/10/k8s/config/secret/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>MySQL - 사용자 추가</title>
      <link>https://ckck803.github.io/2023/05/10/mysql/user/</link>
      <guid>https://ckck803.github.io/2023/05/10/mysql/user/</guid>
      <pubDate>Tue, 09 May 2023 16:16:13 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/database/mysql/MySQL.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;사용자-추가&quot;&gt;&lt;a href=&quot;#사용자-추가&quot; class=&quot;headerlink&quot; title=&quot;사용자 추가&quot;&gt;&lt;/a&gt;사용자 추가&lt;/h2&gt;&lt;figu</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/database/mysql/MySQL.png"></p><h2 id="사용자-추가"><a href="#사용자-추가" class="headerlink" title="사용자 추가"></a>사용자 추가</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;[userid]&#x27;</span>;</span><br><span class="line"><span class="comment">-- localhost 에서만 접속할 수 있는 계정 생성</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;[userid]&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- 외부에서 접근 가능한 계정 생성</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;[userid]&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="권한-부여하기"><a href="#권한-부여하기" class="headerlink" title="권한 부여하기"></a>권한 부여하기</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- select 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- update 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">update</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- insert 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">insert</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- delete 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">delete</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- select, update, insert 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span>, <span class="keyword">update</span>, <span class="keyword">insert</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="특정-데이터-베이스에-대한-접근-부여"><a href="#특정-데이터-베이스에-대한-접근-부여" class="headerlink" title="특정 데이터 베이스에 대한 접근 부여"></a>특정 데이터 베이스에 대한 접근 부여</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- [Database 명] 데이터베이스에 select 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> privileges <span class="keyword">on</span> [Database 명].<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="User-에-따른-데이터-베이스-접근-부여"><a href="#User-에-따른-데이터-베이스-접근-부여" class="headerlink" title="User 에 따른 데이터 베이스 접근 부여"></a>User 에 따른 데이터 베이스 접근 부여</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- localhost User 에게 전체 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span><span class="variable">@localhost</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br><span class="line"><span class="comment">-- 외부접근 User 에게 전체 권한 부여</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;[userid]&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;[비밀번호]&#x27;</span>;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Develop/">Develop</category>
      
      <category domain="https://ckck803.github.io/categories/Develop/MySQL/">MySQL</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/10/mysql/user/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - ItemWriter</title>
      <link>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/</link>
      <guid>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/</guid>
      <pubDate>Tue, 09 May 2023 06:25:35 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;출처&quot;&gt;&lt;a href=&quot;#출처&quot; class=&quot;headerlink&quot; title=&quot;출처&quot;&gt;&lt;/a&gt;출처&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;해당 포스트는 정수원 강사님의 &lt;a href=&quot;https://www.inflearn.com/course/%EC%8A</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="출처"><a href="#출처" class="headerlink" title="출처"></a>출처</h2><ul><li>해당 포스트는 정수원 강사님의 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98/dashboard">스프링 배치 - Spring Boot 기반으로 개발하는 Spring Batch</a> 강의를 바탕으로 작성 됐습니다.</li></ul><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/" title="Spring Batch - ItemWriter">Spring Batch - ItemWriter</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/" title="Spring Batch - ItemProcessor">Spring Batch - ItemProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/" title="Spring Batch - ItemReader">Spring Batch - ItemReader</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/" title="Spring Batch - ChunkProvider 와 ChunkProcessor">Spring Batch - ChunkProvider 와 ChunkProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkOrientedTasklet/" title="Spring Batch - ChunkOrientedTasklet">Spring Batch - ChunkOrientedTasklet</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-Chunk/" title="Spring Batch - Chunk 기반 Step">Spring Batch - Chunk 기반 Step</a></li><li><a href="/2023/05/08/springboot/spring-batch/flow/spring-batch-24-FlowJob/" title="Spring Batch - 24. FlowJob">Spring Batch - 24. FlowJob</a></li><li><a href="#">Post not found: springboot/spring-batch/tasklet/spring-batch-23-JobStep</a></li><li><a href="/2023/05/06/springboot/spring-batch/tasklet/spring-batch-22-Tasklet/" title="Spring Batch - 22. Tasklet 기반 Step">Spring Batch - 22. Tasklet 기반 Step</a></li><li><a href="/2023/05/04/springboot/spring-batch/tasklet/spring-batch-21-TaskletStep/" title="Spring Batch - 21. TaskletStep">Spring Batch - 21. TaskletStep</a></li><li><a href="/2023/05/04/springboot/spring-batch/step/spring-batch-20-StepBuilderFactory/" title="Spring Batch - 20. StepBuilderFactory 와 StepBuilder">Spring Batch - 20. StepBuilderFactory 와 StepBuilder</a></li><li><a href="/2023/05/03/springboot/spring-batch/job/spring-batch-19-JobIncrementer/" title="Spring Batch - 19. JobParameters 증가 JobParametersIncrementer">Spring Batch - 19. JobParameters 증가 JobParametersIncrementer</a></li><li><a href="/2023/04/06/springboot/spring-batch/job/spring-batch-18-preventRestart/" title="Spring Batch - 18. Job 의 재시작 방지 preventRestart">Spring Batch - 18. Job 의 재시작 방지 preventRestart</a></li><li><a href="/2023/04/05/springboot/spring-batch/job/spring-batch-17-JobParametersValidator/" title="Spring Batch - 17. JobParameters 검증 JobParametersValidator">Spring Batch - 17. JobParameters 검증 JobParametersValidator</a></li><li><a href="/2023/04/04/springboot/spring-batch/job/spring-batch-16-SimpleJob/" title="Spring Batch - 16. SimpleJob 와 SimpleJobLauncher">Spring Batch - 16. SimpleJob 와 SimpleJobLauncher</a></li><li><a href="/2023/04/02/springboot/spring-batch/job/spring-batch-15-JobBuilderFactory/" title="Spring Batch - 15. JobBuilderFactory &amp; JobBuilder">Spring Batch - 15. JobBuilderFactory &amp; JobBuilder</a></li></ul><h2 id="ItemWriter"><a href="#ItemWriter" class="headerlink" title="ItemWriter"></a>ItemWriter</h2><p>ItemWriter는 스텝에서 처리한 데이터를 출력하는 역할을 합니다. ItemWriter는 스텝에서 처리한 모든 데이터를 한 번에 출력하며, 출력 대상은 일반적으로 데이터베이스, 파일 또는 메시징 시스템과 같은 외부 저장소입니다.</p><p>ItemWriter는 일반적으로 데이터베이스에 대한 INSERT, UPDATE 또는 DELETE 쿼리를 실행하거나, 파일에 대한 출력을 수행하거나, 메시징 시스템의 큐 또는 주제에 데이터를 전송하는 데 사용됩니다.</p><p>Spring Batch는 다양한 유형의 ItemWriter를 제공합니다. 일반적으로 사용되는 ItemWriter 유형은 다음과 같습니다.</p><ul><li>JdbcBatchItemWriter: JDBC를 사용하여 데이터베이스에 대한 배치 INSERT, UPDATE 또는 DELETE 쿼리를 실행하는 데 사용됩니다.</li><li>JpaItemWriter: JPA를 사용하여 데이터를 저장하는 데 사용됩니다.</li><li>FlatFileItemWriter: CSV, 고정 길이 또는 구분 기호로 구분된 파일에 데이터를 씁니다.</li><li>StaxEventItemWriter: XML 형식으로 데이터를 씁니다.</li><li>JmsItemWriter: JMS 대기열에 데이터를 전송합니다.</li></ul><p><img src="/images/spring-batch/ch7/itemWriter.png"></p><h4 id="ItemWriter-인터페이스"><a href="#ItemWriter-인터페이스" class="headerlink" title="ItemWriter 인터페이스"></a>ItemWriter 인터페이스</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ItemWriter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(Serializable checkpoint)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeItems</span><span class="params">(List&lt;Object&gt; items)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Serializable <span class="title function_">checkpointInfo</span><span class="params">()</span> <span class="keyword">throws</span> Exception; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ItemWriter-구현체"><a href="#ItemWriter-구현체" class="headerlink" title="ItemWriter 구현체"></a>ItemWriter 구현체</h2><h4 id="JdbcBatchItemWriter"><a href="#JdbcBatchItemWriter" class="headerlink" title="JdbcBatchItemWriter"></a>JdbcBatchItemWriter</h4><p>JdbcBatchItemWriter는 Spring Batch 프레임워크에서 제공하는 ItemWriter 인터페이스를 구현한 클래스 중 하나입니다. JDBC 데이터베이스와 상호 작용하는 데 사용됩니다.</p><p>이 ItemWriter는 여러 개의 항목을 받아서 배치 작업으로 일괄 처리할 수 있습니다. 일괄 처리는 내부적으로 트랜잭션으로 묶여 처리되므로 모든 항목이 성공적으로 쓰여지거나 모든 항목이 롤백됩니다.</p><p>JdbcBatchItemWriter는 다음과 같은 방식으로 작동합니다.</p><ol><li>쓰기 전용 연결을 가져옵니다.</li><li>모든 항목을 배치로 그룹화합니다.</li><li>배치 내의 모든 항목을 PreparedStatementSetter를 사용하여 PreparedStatement 객체에 매핑합니다.</li><li>PreparedStatement 객체를 실행합니다.</li><li>결과를 확인하고 배치 작업 내의 모든 항목이 성공적으로 처리되었는지 확인합니다.</li><li>결과를 반환하고 쓰기 전용 연결을 반환합니다.</li></ol><p>JdbcBatchItemWriter는 대량의 데이터를 처리해야하는 경우 유용합니다. 이를 통해 데이터베이스 작업 수를 줄이고 성능을 높일 수 있습니다.</p><h4 id="JpaItemWriter"><a href="#JpaItemWriter" class="headerlink" title="JpaItemWriter"></a>JpaItemWriter</h4><p>paItemWriter는 Spring Batch 프레임워크에서 제공하는 ItemWriter 인터페이스를 구현한 클래스 중 하나입니다. JPA(Java Persistence API)를 사용하여 객체를 데이터베이스에 쓰는 데 사용됩니다.</p><p>이 ItemWriter는 여러 개의 항목을 받아서 배치 작업으로 일괄 처리할 수 있습니다. 일괄 처리는 내부적으로 트랜잭션으로 묶여 처리되므로 모든 항목이 성공적으로 쓰여지거나 모든 항목이 롤백됩니다.</p><p>JpaItemWriter는 다음과 같은 방식으로 작동합니다.</p><ol><li>쓰기 전용 EntityManager를 가져옵니다.</li><li>모든 항목을 배치로 그룹화합니다.</li><li>배치 내의 모든 항목을 EntityManager를 사용하여 영속화합니다.</li><li>EntityManager의 flush() 메서드를 호출하여 변경 사항을 데이터베이스에 적용합니다.</li><li>결과를 확인하고 배치 작업 내의 모든 항목이 성공적으로 처리되었는지 확인합니다.</li><li>결과를 반환하고 쓰기 전용 EntityManager를 반환합니다.</li></ol><p>JpaItemWriter는 JPA를 사용하여 객체를 데이터베이스에 쓰는 데 유용합니다. 이를 통해 객체 그래프를 쉽게 저장할 수 있고, 복잡한 쿼리 작성을 피할 수 있습니다. 또한 JPA의 일관성과 트랜잭션 관리 기능을 활용할 수 있습니다.</p><h4 id="FlatFileItemWriter"><a href="#FlatFileItemWriter" class="headerlink" title="FlatFileItemWriter"></a>FlatFileItemWriter</h4><p>FlatFileItemWriter는 Spring Batch 프레임워크에서 제공하는 ItemWriter 인터페이스를 구현한 클래스 중 하나입니다. 이 클래스는 CSV, TSV, 고정 너비 파일 등과 같은 평면 파일을 생성하는 데 사용됩니다.</p><p>FlatFileItemWriter는 데이터를 출력할 파일 이름 및 위치, 필드 구분자, 줄 바꿈 문자 등 출력 파일의 형식을 지정할 수 있는 다양한 설정 옵션을 제공합니다. 이 클래스는 또한 ItemWriter 인터페이스의 write() 메서드를 구현하여 ItemReader에서 읽은 데이터를 출력 파일에 쓰는 데 사용됩니다.</p><p>FlatFileItemWriter를 사용하려면 다음과 같은 단계를 수행해야 합니다.</p><ol><li>FlatFileItemWriter를 구성합니다. 이 구성 단계에서는 출력 파일의 이름, 위치, 필드 구분자, 줄 바꿈 문자 등 출력 파일의 형식을 지정합니다.</li><li>ItemReader에서 데이터를 읽어와 ItemProcessor에서 처리합니다.</li><li>FlatFileItemWriter.write() 메서드를 호출하여 처리된 데이터를 출력 파일에 씁니다. 이 메서드는 쓰기 작업을 버퍼링하고, 일정한 크기가 될 때마다 출력 파일에 씁니다.</li><li>쓰기 작업이 완료되면 FlatFileItemWriter.close() 메서드를 호출하여 출력 파일을 닫습니다.</li></ol><p>FlatFileItemWriter는 대용량 데이터 파일을 생성하는 데 적합합니다. 이를 통해 파일 생성 및 처리 속도를 높일 수 있습니다.</p><h4 id="StaxEventItemWriter"><a href="#StaxEventItemWriter" class="headerlink" title="StaxEventItemWriter"></a>StaxEventItemWriter</h4><p>StaxEventItemWriter는 Spring Batch 프레임워크에서 제공하는 ItemWriter 인터페이스를 구현한 클래스 중 하나입니다. 이 클래스는 XML 형식으로 데이터를 출력하는 데 사용됩니다.</p><p>StaxEventItemWriter는 StAX(Streaming API for XML)를 사용하여 XML 문서를 생성합니다. 이 클래스는 XML 스트림을 작성하는 데 필요한 설정을 제공합니다. 예를 들어 출력 파일 이름, 루트 엘리먼트 이름, 네임스페이스 등을 지정할 수 있습니다.</p><p>StaxEventItemWriter를 사용하려면 다음과 같은 단계를 수행해야 합니다.</p><ol><li>StaxEventItemWriter를 구성합니다. 이 구성 단계에서는 출력 파일 이름, 루트 엘리먼트 이름, 네임스페이스 등을 지정합니다.</li><li>ItemReader에서 데이터를 읽어와 ItemProcessor에서 처리합니다.</li><li>StaxEventItemWriter.write() 메서드를 호출하여 처리된 데이터를 XML 형식으로 출력 파일에 씁니다. 이 메서드는 쓰기 작업을 버퍼링하고, 일정한 크기가 될 때마다 출력 파일에 씁니다.</li><li>쓰기 작업이 완료되면 StaxEventItemWriter.close() 메서드를 호출하여 출력 파일을 닫습니다.</li></ol><p>StaxEventItemWriter는 대용량 XML 파일을 생성하는 데 적합합니다. 이를 통해 파일 생성 및 처리 속도를 높일 수 있습니다. 또한, StaxEventItemWriter는 다른 XML 라이브러리보다 메모리 사용량이 적으며, 대규모 XML 문서를 처리하는 데 최적화되어 있습니다.</p><h4 id="JmsItemWriter"><a href="#JmsItemWriter" class="headerlink" title="JmsItemWriter"></a>JmsItemWriter</h4><p>JmsItemWriter는 Spring Batch 프레임워크에서 제공하는 ItemWriter 인터페이스를 구현한 클래스 중 하나입니다. 이 클래스는 Java Messaging Service(JMS)를 사용하여 메시지를 보내는 데 사용됩니다.</p><p>JmsItemWriter는 JMS 목적지를 구성하는 데 필요한 설정을 제공합니다. 예를 들어 연결 팩토리, 목적지 이름, 전송 모드 등을 지정할 수 있습니다.</p><p>JmsItemWriter를 사용하려면 다음과 같은 단계를 수행해야 합니다.</p><ol><li>JmsItemWriter를 구성합니다. 이 구성 단계에서는 연결 팩토리, 목적지 이름, 전송 모드 등을 지정합니다.</li><li>ItemReader에서 데이터를 읽어와 ItemProcessor에서 처리합니다.</li><li>JmsItemWriter.write() 메서드를 호출하여 처리된 데이터를 JMS 메시지로 보냅니다.</li><li>쓰기 작업이 완료되면 JmsItemWriter.close() 메서드를 호출하여 JMS 리소스를 닫습니다.</li></ol><p>JmsItemWriter는 대용량 메시지를 처리하는 데 적합합니다. 이를 통해 메시지 전송 속도를 높일 수 있습니다. 또한, JmsItemWriter는 JMS 기반 시스템과 연동하여 데이터를 전송하는 데 유용합니다.</p>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/">Step</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/Chunk/">Chunk</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - ItemProcessor</title>
      <link>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/</link>
      <guid>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/</guid>
      <pubDate>Tue, 09 May 2023 05:25:35 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;출처&quot;&gt;&lt;a href=&quot;#출처&quot; class=&quot;headerlink&quot; title=&quot;출처&quot;&gt;&lt;/a&gt;출처&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;해당 포스트는 정수원 강사님의 &lt;a href=&quot;https://www.inflearn.com/course/%EC%8A</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="출처"><a href="#출처" class="headerlink" title="출처"></a>출처</h2><ul><li>해당 포스트는 정수원 강사님의 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98/dashboard">스프링 배치 - Spring Boot 기반으로 개발하는 Spring Batch</a> 강의를 바탕으로 작성 됐습니다.</li></ul><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/" title="Spring Batch - ItemWriter">Spring Batch - ItemWriter</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/" title="Spring Batch - ItemProcessor">Spring Batch - ItemProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/" title="Spring Batch - ItemReader">Spring Batch - ItemReader</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/" title="Spring Batch - ChunkProvider 와 ChunkProcessor">Spring Batch - ChunkProvider 와 ChunkProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkOrientedTasklet/" title="Spring Batch - ChunkOrientedTasklet">Spring Batch - ChunkOrientedTasklet</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-Chunk/" title="Spring Batch - Chunk 기반 Step">Spring Batch - Chunk 기반 Step</a></li><li><a href="/2023/05/08/springboot/spring-batch/flow/spring-batch-24-FlowJob/" title="Spring Batch - 24. FlowJob">Spring Batch - 24. FlowJob</a></li><li><a href="#">Post not found: springboot/spring-batch/tasklet/spring-batch-23-JobStep</a></li><li><a href="/2023/05/06/springboot/spring-batch/tasklet/spring-batch-22-Tasklet/" title="Spring Batch - 22. Tasklet 기반 Step">Spring Batch - 22. Tasklet 기반 Step</a></li><li><a href="/2023/05/04/springboot/spring-batch/tasklet/spring-batch-21-TaskletStep/" title="Spring Batch - 21. TaskletStep">Spring Batch - 21. TaskletStep</a></li><li><a href="/2023/05/04/springboot/spring-batch/step/spring-batch-20-StepBuilderFactory/" title="Spring Batch - 20. StepBuilderFactory 와 StepBuilder">Spring Batch - 20. StepBuilderFactory 와 StepBuilder</a></li><li><a href="/2023/05/03/springboot/spring-batch/job/spring-batch-19-JobIncrementer/" title="Spring Batch - 19. JobParameters 증가 JobParametersIncrementer">Spring Batch - 19. JobParameters 증가 JobParametersIncrementer</a></li><li><a href="/2023/04/06/springboot/spring-batch/job/spring-batch-18-preventRestart/" title="Spring Batch - 18. Job 의 재시작 방지 preventRestart">Spring Batch - 18. Job 의 재시작 방지 preventRestart</a></li><li><a href="/2023/04/05/springboot/spring-batch/job/spring-batch-17-JobParametersValidator/" title="Spring Batch - 17. JobParameters 검증 JobParametersValidator">Spring Batch - 17. JobParameters 검증 JobParametersValidator</a></li><li><a href="/2023/04/04/springboot/spring-batch/job/spring-batch-16-SimpleJob/" title="Spring Batch - 16. SimpleJob 와 SimpleJobLauncher">Spring Batch - 16. SimpleJob 와 SimpleJobLauncher</a></li><li><a href="/2023/04/02/springboot/spring-batch/job/spring-batch-15-JobBuilderFactory/" title="Spring Batch - 15. JobBuilderFactory &amp; JobBuilder">Spring Batch - 15. JobBuilderFactory &amp; JobBuilder</a></li></ul><h2 id="ItemProcessor"><a href="#ItemProcessor" class="headerlink" title="ItemProcessor"></a>ItemProcessor</h2><p>ItemProcessor는 Step 내에서 사용될 데이터를 변환 또는 가공하는 역할을 합니다. ItemReader가 읽어온 데이터를 ItemProcessor가 받아들여 처리하고, 처리한 결과를 ItemWriter에 전달합니다.</p><p>ItemProcessor는 일반적으로 데이터 변환, 유효성 검사, 필터링 또는 데이터 가공과 같은 작업을 수행하는 데 사용됩니다. 예를 들어, ItemProcessor를 사용하여 입력 데이터의 길이를 제한하거나, 데이터를 수정하거나, 유효성을 검사하거나, 데이터를 필터링할 수 있습니다.</p><p>ItemProcessor는 단일 입력 값을 받아 처리 결과를 반환하는 단순한 함수형 인터페이스인 ItemProcessor&lt;T, S&gt;를 구현합니다. 여기서 T는 입력 유형이고, S는 출력 유형입니다.</p><p>ItemProcessor는 스텝 처리 과정에서 중요한 역할을 합니다. 데이터를 변환 또는 가공하여 ItemWriter가 처리할 수 있는 형식으로 변환하므로, 대용량 데이터 세트를 효율적으로 처리하는 데 매우 유용합니다. 또한, ItemProcessor를 사용하여 데이터 유효성 검사 및 데이터 가공 작업을 수행하여 데이터 품질을 유지하고, 필요한 작업을 수행할 수 있습니다.</p><h4 id="ItemProcessor-인터페이스"><a href="#ItemProcessor-인터페이스" class="headerlink" title="ItemProcessor 인터페이스"></a>ItemProcessor 인터페이스</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ItemProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">processItem</span><span class="params">(Object item)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/spring-batch/ch7/itemProcessor.png"></p><h2 id="ItemProccesor-구현체-종류"><a href="#ItemProccesor-구현체-종류" class="headerlink" title="ItemProccesor 구현체 종류"></a>ItemProccesor 구현체 종류</h2><h4 id="ClassifierCompoisteItemProcessor"><a href="#ClassifierCompoisteItemProcessor" class="headerlink" title="ClassifierCompoisteItemProcessor"></a>ClassifierCompoisteItemProcessor</h4><p>ClassifierCompositeItemProcessor는 Spring Batch의 ItemProcessor 인터페이스를 구현한 클래스로, 다중 프로세싱 전략을 적용할 수 있도록 설계된 컴포지트(Composite) 패턴의 구현체입니다.</p><p>ClassifierCompositeItemProcessor는 Classifier라는 인터페이스를 구현하고 있습니다. Classifier는 하나의 입력 값을 기반으로 여러 개의 출력 값을 생성할 수 있는 기능을 제공합니다. ClassifierCompositeItemProcessor는 이 기능을 활용하여 하나의 입력 항목을 여러 개의 ItemProcessor에 전달하여 처리할 수 있습니다.</p><h4 id="CmopositeItemProcessor"><a href="#CmopositeItemProcessor" class="headerlink" title="CmopositeItemProcessor"></a>CmopositeItemProcessor</h4><h4 id="CustomItemProcessor"><a href="#CustomItemProcessor" class="headerlink" title="CustomItemProcessor"></a>CustomItemProcessor</h4>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/">Step</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/Chunk/">Chunk</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - ItemReader</title>
      <link>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/</link>
      <guid>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/</guid>
      <pubDate>Tue, 09 May 2023 04:25:35 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;출처&quot;&gt;&lt;a href=&quot;#출처&quot; class=&quot;headerlink&quot; title=&quot;출처&quot;&gt;&lt;/a&gt;출처&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;해당 포스트는 정수원 강사님의 &lt;a href=&quot;https://www.inflearn.com/course/%EC%8A</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="출처"><a href="#출처" class="headerlink" title="출처"></a>출처</h2><ul><li>해당 포스트는 정수원 강사님의 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98/dashboard">스프링 배치 - Spring Boot 기반으로 개발하는 Spring Batch</a> 강의를 바탕으로 작성 됐습니다.</li></ul><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/" title="Spring Batch - ItemWriter">Spring Batch - ItemWriter</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/" title="Spring Batch - ItemProcessor">Spring Batch - ItemProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/" title="Spring Batch - ItemReader">Spring Batch - ItemReader</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/" title="Spring Batch - ChunkProvider 와 ChunkProcessor">Spring Batch - ChunkProvider 와 ChunkProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkOrientedTasklet/" title="Spring Batch - ChunkOrientedTasklet">Spring Batch - ChunkOrientedTasklet</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-Chunk/" title="Spring Batch - Chunk 기반 Step">Spring Batch - Chunk 기반 Step</a></li><li><a href="/2023/05/08/springboot/spring-batch/flow/spring-batch-24-FlowJob/" title="Spring Batch - 24. FlowJob">Spring Batch - 24. FlowJob</a></li><li><a href="#">Post not found: springboot/spring-batch/tasklet/spring-batch-23-JobStep</a></li><li><a href="/2023/05/06/springboot/spring-batch/tasklet/spring-batch-22-Tasklet/" title="Spring Batch - 22. Tasklet 기반 Step">Spring Batch - 22. Tasklet 기반 Step</a></li><li><a href="/2023/05/04/springboot/spring-batch/tasklet/spring-batch-21-TaskletStep/" title="Spring Batch - 21. TaskletStep">Spring Batch - 21. TaskletStep</a></li><li><a href="/2023/05/04/springboot/spring-batch/step/spring-batch-20-StepBuilderFactory/" title="Spring Batch - 20. StepBuilderFactory 와 StepBuilder">Spring Batch - 20. StepBuilderFactory 와 StepBuilder</a></li><li><a href="/2023/05/03/springboot/spring-batch/job/spring-batch-19-JobIncrementer/" title="Spring Batch - 19. JobParameters 증가 JobParametersIncrementer">Spring Batch - 19. JobParameters 증가 JobParametersIncrementer</a></li><li><a href="/2023/04/06/springboot/spring-batch/job/spring-batch-18-preventRestart/" title="Spring Batch - 18. Job 의 재시작 방지 preventRestart">Spring Batch - 18. Job 의 재시작 방지 preventRestart</a></li><li><a href="/2023/04/05/springboot/spring-batch/job/spring-batch-17-JobParametersValidator/" title="Spring Batch - 17. JobParameters 검증 JobParametersValidator">Spring Batch - 17. JobParameters 검증 JobParametersValidator</a></li><li><a href="/2023/04/04/springboot/spring-batch/job/spring-batch-16-SimpleJob/" title="Spring Batch - 16. SimpleJob 와 SimpleJobLauncher">Spring Batch - 16. SimpleJob 와 SimpleJobLauncher</a></li><li><a href="/2023/04/02/springboot/spring-batch/job/spring-batch-15-JobBuilderFactory/" title="Spring Batch - 15. JobBuilderFactory &amp; JobBuilder">Spring Batch - 15. JobBuilderFactory &amp; JobBuilder</a></li></ul><h2 id="ItemReader"><a href="#ItemReader" class="headerlink" title="ItemReader"></a>ItemReader</h2><p>ItemReader는 스텝 내에서 사용될 데이터를 읽는 역할을 합니다. ItemReader는 스텝이 시작될 때 호출되며, 데이터 소스에서 데이터를 읽어 Chunk 단위로 ItemProcessor에 전달합니다.</p><p>ItemReader는 일반적으로 파일, 데이터베이스 또는 메시징 시스템과 같은 외부 데이터 소스에서 데이터를 읽는 데 사용됩니다. Spring Batch는 다양한 유형의 ItemReader를 지원하며, 일반적으로 사용되는 ItemReader 유형은 다음과 같습니다.</p><ul><li>FlatFileItemReader: CSV, 고정 길이 또는 구분 기호로 구분된 파일에서 데이터를 읽는 데 사용됩니다.</li><li>JdbcCursorItemReader: JDBC 쿼리를 실행하고 ResultSet에서 데이터를 읽는 데 사용됩니다.</li><li>JpaPagingItemReader: JPA를 사용하여 페이징 처리를 수행하고 데이터를 읽는 데 사용됩니다.</li><li>StaxEventItemReader: XML 데이터를 읽는 데 사용됩니다.</li><li>JmsItemReader: JMS 대기열에서 데이터를 읽는 데 사용됩니다.</li></ul><p>다수의 구현체들이 ItemReader 와 ItemStream 을 동시에 구현하고 있습니다. ItemStream 은 파일의 스트림을 열거나 종료, DB 커넥션을 열거나 종료, 출력 장치 초기화 등의 작업을 진행합니다.</p><p><img src="/images/spring-batch/ch7/itemReader.png"></p><h2 id="ItemReader-인터페이스"><a href="#ItemReader-인터페이스" class="headerlink" title="ItemReader 인터페이스"></a>ItemReader 인터페이스</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ItemReader</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    T <span class="title function_">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception, UnexpectedInputException, ParseException, NonTransientResourceException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ItemReader-구현체"><a href="#ItemReader-구현체" class="headerlink" title="ItemReader 구현체"></a>ItemReader 구현체</h2><h2 id="FlatFileItemReader"><a href="#FlatFileItemReader" class="headerlink" title="FlatFileItemReader"></a>FlatFileItemReader</h2><p>FlatFileItemReader는 파일에서 데이터를 읽어오기 위해 사용됩니다. 입력 파일은 다양한 형식의 텍스트 파일일 수 있으며, 일반적으로 CSV(Comma-Separated Values) 또는 고정 길이 형식의 파일을 처리하는 데 사용됩니다.</p><p>FlatFileItemReader는 Spring의 Resource 추상화를 사용하여 파일에 대한 참조를 가져오며, 구성 가능한 구분자 및 헤더&#x2F;푸터 처리 기능을 제공합니다. 또한, 파일의 각 레코드를 Java 객체로 변환하여 반환할 수 있으므로, 이를 통해 다른 스프링 배치 구성 요소에서 사용할 수 있는 유용한 데이터 모델을 만들 수 있습니다.</p><h4 id="FlatFileItemReaderBuilder"><a href="#FlatFileItemReaderBuilder" class="headerlink" title="FlatFileItemReaderBuilder"></a>FlatFileItemReaderBuilder</h4><ul><li><p><code>saveState(boolean saveState)</code></p><ul><li>FlatFileItemReader의 상태를 저장할지 여부를 설정합니다. true로 설정하면 상태가 저장되어 재시작 시 이전 상태로 복구됩니다.</li></ul></li><li><p><code>name(String name)</code></p><ul><li>FlatFileItemReader의 이름을 설정합니다. 이 이름은 스텝 구성에서 사용될 수 있습니다.</li></ul></li><li><p><code>maxItemCount(int maxItemCount)</code></p><ul><li>최대 읽기 아이템 수를 설정합니다. 이 값을 설정하면 지정된 수만큼 아이템을 읽은 후 리더가 끝납니다.</li></ul></li><li><p><code>currentItemCount(int currentItemCount)</code></p><ul><li>현재 읽은 아이템 수를 설정합니다. 이 값을 설정하면 리더가 재시작될 때 이전 상태로 복구됩니다.</li></ul></li><li><p><code>addComment(String comment)</code></p><ul><li>주석(comment)을 추가합니다. 이 주석은 읽기 프로세스의 로깅이나 디버깅에 사용될 수 있습니다.</li></ul></li><li><p><code>comments(String... comments</code></p><ul><li>다중 주석(comments)을 추가합니다.</li></ul></li><li><p><code>recordSeparatorPolicy(RecordSeparatorPolicy policy)</code></p><ul><li>레코드 구분 정책(RecordSeparatorPolicy)을 설정합니다. 레코드 구분 정책은 행 사이의 구분자를 기반으로 레코드를 식별하는 데 사용됩니다.</li></ul></li><li><p><code>bufferedReaderFactory(BufferedReaderFactory factory)</code></p><ul><li>BufferedReaderFactory를 설정하여 FlatFileItemReader에서 사용할 BufferedReader를 생성합니다. 사용자 지정 BufferedReader를 사용할 수 있습니다.</li></ul></li><li><p><code>resource(Resource resource)</code></p><ul><li>읽을 리소스(Resource)를 설정합니다. 파일 시스템 경로, 클래스패스 리소스 등을 지정할 수 있습니다.</li></ul></li><li><p><code>strict(boolean strict)</code></p><ul><li>엄격 모드(strict mode)를 설정합니다. 엄격 모드에서는 입력 행에 예상되는 필드 수보다 적은 필드가 있는 경우 예외가 발생합니다.</li></ul></li><li><p><code>encoding(String encoding)</code></p><ul><li>읽을 파일의 인코딩을 설정합니다.</li></ul></li><li><p><code>linesToSkip(int linesToSkip)</code></p><ul><li>읽기 시작 시 건너뛸 행 수를 설정합니다. 파일의 처음 몇 행을 건너뛰고 데이터를 읽을지 결정할 수 있습니다.</li></ul></li><li><p><code>skippedLinesCallback(LineCallbackHandler callback)</code></p><ul><li>건너뛴 행에 대한 콜백 처리를 설정합니다. 건너뛴 행의 내용을 처리할 수 있습니다.</li></ul></li><li><p><code>lineMapper(LineMapper&lt;T&gt; lineMapper)</code></p><ul><li>행을 도메인 객체로 매핑하는 LineMapper를 설정합니다.</li></ul></li><li><p><code>fieldSetMapper(FieldSetMapper&lt;T&gt; mapper)</code></p><ul><li>FieldSetMapper를 설정하여 필드 세트를 도메인 객체로 매핑합니다.</li></ul></li><li><p><code>lineTokenizer(LineTokenizer tokenizer)</code></p><ul><li>행을 필드로 분리하는 LineTokenizer를 설정합니다.</li></ul></li><li><p><code>public DelimitedBuilder&lt;T&gt; delimited()</code></p><ul><li>구분자(delimiter) 기반의 필드 구성을 위한 DelimitedBuilder를 반환합니다.</li></ul></li><li><p><code>public FixedLengthBuilder&lt;T&gt; fixedLength()</code></p><ul><li>고정 길이 필드 구성을 위한 FixedLengthBuilder를 반환합니다. 고정 길이 필드는 특정 위치에서 고정된 길이로 값을 추출합니다.</li></ul></li><li><p><code>targetType(Class&lt;? extends T&gt; targetType</code></p><ul><li>읽은 데이터를 매핑할 도메인 객체의 타입을 설정합니다. 제네릭 타입으로 지정된 타입을 사용합니다.</li></ul></li><li><p><code>prototypeBeanName(String prototypeBeanName)</code></p><ul><li>프로토타입 빈의 이름을 설정합니다. 프로토타입 빈은 매번 생성되는 빈으로, 상태를 공유하지 않습니다.</li></ul></li><li><p><code>beanFactory(BeanFactory beanFactory)</code></p><ul><li>BeanFactory를 설정합니다. FlatFileItemReader가 빈을 생성할 때 사용됩니다.</li></ul></li><li><p><code>customEditors(Map&lt;Class&lt;?&gt;, PropertyEditor&gt; customEditors)</code></p><ul><li>사용자 정의 PropertyEditor를 설정합니다. 특정 타입의 프로퍼티에 대한 변환을 사용자가 정의한 PropertyEditor로 수행할 수 있습니다.</li></ul></li><li><p><code>distanceLimit(int distanceLimit)</code></p><ul><li>거리 제한(distance limit)을 설정합니다. 거리 제한은 필드 추출 시 최대 길이를 제한하는 데 사용됩니다.</li></ul></li><li><p><code>beanMapperStrict(boolean beanMapperStrict)</code></p><ul><li>BeanMapper의 엄격 모드를 설정합니다. 엄격 모드에서는 필드 매핑 오류가 발생하면 예외가 발생합니다.</li></ul></li><li><p><code>public FlatFileItemReader&lt;T&gt; build()</code></p><ul><li>설정된 값들을 기반으로 FlatFileItemReader를 생성합니다.</li></ul></li><li><p><code>private void updateTokenizerValidation(Object tokenizer, int index)</code></p><ul><li>토큰화기(Tokenizer)의 유효성을 업데이트하는 내부 메소드입니다. 일반적으로 사용자는 이 메소드를 직접 호출할 필요는 없습니다.</li></ul></li></ul><h2 id="JdbcCursorItemReader"><a href="#JdbcCursorItemReader" class="headerlink" title="JdbcCursorItemReader"></a>JdbcCursorItemReader</h2><p>JdbcCursorItemReader는 Spring Batch 프레임워크에서 제공하는 ItemReader의 구현체 중 하나로, JDBC를 사용하여 데이터베이스에서 데이터를 읽어오기 위해 사용됩니다.</p><p>JdbcCursorItemReader는 SQL 쿼리를 실행하고 결과 집합을 커서(cursor)를 사용하여 가져옵니다. 이 커서는 결과 집합을 한 번에 전체적으로 가져오지 않고, 필요한 부분만 가져올 수 있도록 합니다. 이는 대규모 데이터베이스 작업에서 효율적으로 메모리를 사용할 수 있도록 도와줍니다.</p><p>JdbcCursorItemReader는 구성 가능한 SQL 쿼리, 매개 변수 바인딩, 페이징 및 정렬을 지원합니다. 또한, 데이터베이스의 각 레코드를 Java 객체로 변환하여 반환할 수 있으므로, 이를 통해 다른 스프링 배치 구성 요소에서 사용할 수 있는 유용한 데이터 모델을 만들 수 있습니다.</p><h4 id="JdbcCursorItemReaderBuilder"><a href="#JdbcCursorItemReaderBuilder" class="headerlink" title="JdbcCursorItemReaderBuilder"></a>JdbcCursorItemReaderBuilder</h4><ul><li><code>saveState(boolean saveState)</code><ul><li>JdbcCursorItemReader의 상태를 저장할지 여부를 설정합니다. true로 설정하면 상태가 저장되어 재시작 시 이전 상태로 복구됩니다.</li></ul></li><li><code>name(String name)</code><ul><li>JdbcCursorItemReader의 이름을 설정합니다. 이 이름은 스텝 구성에서 사용될 수 있습니다.</li></ul></li><li><code>maxItemCount(int maxItemCount)</code><ul><li>최대 읽기 아이템 수를 설정합니다. 이 값을 설정하면 지정된 수만큼 아이템을 읽은 후 리더가 끝납니다.</li></ul></li><li><code>currentItemCount(int currentItemCount)</code><ul><li>현재 읽은 아이템 수를 설정합니다. 이 값을 설정하면 리더가 재시작될 때 이전 상태로 복구됩니다.</li></ul></li><li><code>dataSource(DataSource dataSource)</code><ul><li>사용할 데이터 소스(DataSource)를 설정합니다. JDBC 연결을 수행할 때 사용됩니다.</li></ul></li><li><code>fetchSize(int fetchSize)</code><ul><li>한 번에 가져올 레코드 수(fetch size)를 설정합니다. 큰 데이터셋을 처리할 때 성능을 향상시키는 데 도움이 됩니다.</li></ul></li><li><code>maxRows(int maxRows)</code><ul><li>최대 반환되는 행 수를 제한합니다.</li></ul></li><li><code>queryTimeout(int queryTimeout)</code><ul><li>쿼리 실행 시 타임아웃 시간을 설정합니다.</li></ul></li><li><code>ignoreWarnings(boolean ignoreWarnings)</code><ul><li>경고(warning)를 무시할지 여부를 설정합니다.</li></ul></li><li><code>verifyCursorPosition(boolean verifyCursorPosition)</code><ul><li>커서 위치를 확인할지 여부를 설정합니다. 커서 위치 확인은 읽기 진행 중 커서가 정상적인 위치에 있는지 확인하는 작업입니다.</li></ul></li><li><code>driverSupportsAbsolute(boolean driverSupportsAbsolute)</code><ul><li>드라이버가 절대 커서 위치를 지원하는지 여부를 설정합니다.</li></ul></li><li><code>useSharedExtendedConnection(boolean useSharedExtendedConnection)</code><ul><li>공유 확장 연결(shared extended connection)을 사용할지 여부를 설정합니다.</li></ul></li><li><code>preparedStatementSetter(PreparedStatementSetter preparedStatementSetter)</code><ul><li>PreparedStatementSetter를 설정하여 SQL 문에 인수를 바인딩합니다.</li></ul></li><li><code>queryArguments(Object... args)</code><ul><li>SQL 쿼리의 인수를 설정합니다. 가변 인수로 전달되며, 쿼리에 매핑되는 순서대로 인수를 제공합니다.</li></ul></li><li><code>queryArguments(Object[] args, int[] types)</code><ul><li>SQL 쿼리의 인수와 해당 인수의 JDBC 타입을 설정합니다.</li></ul></li><li><code>queryArguments(List&lt;?&gt; args)</code><ul><li>SQL 쿼리의 인수를 설정합니다. List 형태로 인수를 전달합니다.</li></ul></li><li><code>sql(String sql)</code><ul><li>실행할 SQL 문을 설정합니다.</li></ul></li><li><code>rowMapper(RowMapper&lt;T&gt; rowMapper)</code><ul><li>RowMapper를 설정하여 ResultSet의 행을 도메인 객체로 매핑합니다.</li></ul></li><li><code>beanRowMapper(Class&lt;T&gt; mappedClass)</code><ul><li>BeanRowMapper를 설정하여 ResultSet의 행을 지정된 도메인 객체 타입으로 매핑합니다.</li></ul></li><li></li></ul><h2 id="JpaPagingItemReader"><a href="#JpaPagingItemReader" class="headerlink" title="JpaPagingItemReader"></a>JpaPagingItemReader</h2><p>JpaPagingItemReader는 Spring Batch 프레임워크에서 제공하는 ItemReader의 구현체 중 하나로, JPA(Java Persistence API)를 사용하여 데이터베이스에서 페이지별로 데이터를 읽어오기 위해 사용됩니다.</p><p>JpaPagingItemReader는 Spring Data JPA를 기반으로 구현되어 있으며, 페이징 및 정렬을 지원합니다. 이는 대규모 데이터베이스 작업에서 효율적으로 메모리를 사용할 수 있도록 도와줍니다.</p><p>JpaPagingItemReader는 구성 가능한 JPA 쿼리, 매개 변수 바인딩, 페이징 및 정렬을 지원합니다. 또한, 데이터베이스의 각 레코드를 Java 객체로 변환하여 반환할 수 있으므로, 이를 통해 다른 스프링 배치 구성 요소에서 사용할 수 있는 유용한 데이터 모델을 만들 수 있습니다.</p><h4 id="JpaPagingItemReaderBuilder"><a href="#JpaPagingItemReaderBuilder" class="headerlink" title="JpaPagingItemReaderBuilder"></a>JpaPagingItemReaderBuilder</h4><ul><li><p><code>saveState(boolean saveState)</code></p><ul><li>JpaPagingItemReader의 상태를 저장할지 여부를 설정합니다. true로 설정하면 상태가 저장되어 재시작 시 이전 상태로 복구됩니다.</li></ul></li><li><p><code>name(String name)</code></p><ul><li>JpaPagingItemReader의 이름을 설정합니다. 이 이름은 스텝 구성에서 사용될 수 있습니다.</li></ul></li><li><p><code>maxItemCount(int maxItemCount)</code></p><ul><li>최대 읽기 아이템 수를 설정합니다. 이 값을 설정하면 지정된 수만큼 아이템을 읽은 후 리더가 끝납니다.</li></ul></li><li><p><code>currentItemCount(int currentItemCount)</code></p><ul><li>현재 읽은 아이템 수를 설정합니다. 이 값을 설정하면 리더가 재시작될 때 이전 상태로 복구됩니다.</li></ul></li><li><p><code>pageSize(int pageSize)</code></p><ul><li>한 페이지에서 읽을 아이템 수를 설정합니다. 페이지마다 일괄 처리될 아이템 수를 제어하는 데 사용됩니다.</li></ul></li><li><p><code>parameterValues(Map&lt;String, Object&gt; parameterValues)</code></p><ul><li>JPA 쿼리의 매개변수 값을 설정합니다. 매개변수 이름과 값을 매핑하는 맵을 전달합니다.</li></ul></li><li><p><code>queryProvider(JpaQueryProvider queryProvider)</code></p><ul><li>JpaQueryProvider를 설정하여 JPA 쿼리를 제공합니다. JpaQueryProvider는 데이터베이스와 관련된 쿼리를 생성하는 인터페이스입니다.</li></ul></li><li><p><code>queryString(String queryString)</code></p><ul><li>직접 쿼리 문자열을 설정합니다. JPA 쿼리를 직접 지정하고자 할 때 사용됩니다.</li></ul></li><li><p><code>transacted(boolean transacted)</code></p><ul><li>트랜잭션 처리 여부를 설정합니다. true로 설정하면 리더는 트랜잭션 내에서 실행됩니다.</li></ul></li><li><p><code>entityManagerFactory(EntityManagerFactory entityManagerFactory)</code></p><ul><li>사용할 EntityManagerFactory를 설정합니다. JPA 연결을 수행할 때 사용됩니다.</li></ul></li><li><p><code>build()</code></p><ul><li>설정된 값들을 기반으로 JpaPagingItemReader를 생성합니다.</li></ul></li></ul><h2 id="StaxEventItemReader"><a href="#StaxEventItemReader" class="headerlink" title="StaxEventItemReader"></a>StaxEventItemReader</h2><p>StaxEventItemReader는 Spring Batch 프레임워크에서 제공하는 ItemReader의 구현체 중 하나로, XML 문서에서 데이터를 읽어오기 위해 사용됩니다.</p><p>StaxEventItemReader는 XML을 파싱하는 데에 StAX(Streaming API for XML)를 사용합니다. 이를 통해 대용량 XML 파일을 효율적으로 처리할 수 있으며, 메모리 사용량을 줄일 수 있습니다.</p><p>StaxEventItemReader는 구성 가능한 XML 스키마, 태그 이름 및 XPath를 지원합니다. 또한, XML의 각 노드를 Java 객체로 변환하여 반환할 수 있으므로, 이를 통해 다른 스프링 배치 구성 요소에서 사용할 수 있는 유용한 데이터 모델을 만들 수 있습니다.</p><h4 id="StaxEventItemReaderBuilder"><a href="#StaxEventItemReaderBuilder" class="headerlink" title="StaxEventItemReaderBuilder"></a>StaxEventItemReaderBuilder</h4><ul><li><p><code>saveState(boolean saveState)</code></p><ul><li>StaxEventItemReader의 상태를 저장할지 여부를 설정합니다. true로 설정하면 상태가 저장되어 재시작 시 이전 상태로 복구됩니다.</li></ul></li><li><p><code>name(String name)</code></p><ul><li>StaxEventItemReader의 이름을 설정합니다. 이 이름은 스텝 구성에서 사용될 수 있습니다.</li></ul></li><li><p><code>maxItemCount(int maxItemCount)</code></p><ul><li>최대 읽기 아이템 수를 설정합니다. 이 값을 설정하면 지정된 수만큼 아이템을 읽은 후 리더가 끝납니다.</li></ul></li><li><p><code>currentItemCount(int currentItemCount)</code></p><ul><li>현재 읽은 아이템 수를 설정합니다. 이 값을 설정하면 리더가 재시작될 때 이전 상태로 복구됩니다.</li></ul></li><li><p><code>resource(Resource resource)</code></p><ul><li>읽을 XML 리소스(Resource)를 설정합니다.</li></ul></li><li><p><code>unmarshaller(Unmarshaller unmarshaller)</code></p><ul><li>Unmarshaller를 설정하여 XML을 도메인 객체로 언마샬링합니다.</li></ul></li><li><p><code>addFragmentRootElements(String... fragmentRootElements)</code></p><ul><li>파편(fragment)의 루트 엘리먼트를 추가합니다. 지정된 엘리먼트 이름의 하위 요소를 아이템으로 처리합니다.</li></ul></li><li><p><code>addFragmentRootElements(List&lt;String&gt; fragmentRootElements)</code></p><ul><li>파편(fragment)의 루트 엘리먼트를 추가합니다. 지정된 엘리먼트 이름의 하위 요소를 아이템으로 처리합니다. List 형태로 엘리먼트 이름을 전달합니다.</li></ul></li><li><p><code>strict(boolean strict)</code></p><ul><li>엄격 모드(strict mode)를 설정합니다. 엄격 모드에서는 XML 구조에 대한 검증이 수행되며, 오류가 발생하면 예외가 발생합니다.</li></ul></li><li><p><code>xmlInputFactory(XMLInputFactory xmlInpzutFactory)</code></p><ul><li>사용할 XMLInputFactory를 설정합니다. StAX 이벤트 리더를 생성하는 데 사용됩니다.</li></ul></li><li><p><code>encoding(String encoding)</code></p><ul><li>XML 인코딩을 설정합니다. 읽을 XML의 인코딩을 지정할 수 있습니다.</li></ul></li><li><p><code>build()</code></p><ul><li>설정된 값들을 기반으로 StaxEventItemReader를 생성합니다.</li></ul></li></ul><h2 id="JmsItemReader"><a href="#JmsItemReader" class="headerlink" title="JmsItemReader"></a>JmsItemReader</h2><blockquote><p>JmsItemReaderBuilder 에 의해 생성되는 ItemReader의 구현체 중 하나</p></blockquote><p>JMS(Java Message Service)를 사용하여 메시지 큐에서 데이터를 읽어오기 위해 사용됩니다.</p><p>JmsItemReader는 구성 가능한 JMS 목적지(destination), 메시지 선택자(selector), 메시지 수신 타임아웃(timeout) 등을 지원합니다. 이를 통해 메시지 큐에서 필요한 데이터를 선택적으로 읽어오거나, 메시지 큐에서 일정 시간 이내에 수신되지 않은 메시지를 자동으로 처리할 수 있습니다.</p><p>JmsItemReader는 메시지를 Java 객체로 변환하여 반환할 수 있으므로, 이를 통해 다른 스프링 배치 구성 요소에서 사용할 수 있는 유용한 데이터 모델을 만들 수 있습니다.</p><h4 id="JmsItemReaderBuilder"><a href="#JmsItemReaderBuilder" class="headerlink" title="JmsItemReaderBuilder"></a>JmsItemReaderBuilder</h4><ul><li><p><code>jmsTemplate(JmsOperations jmsTemplate)</code></p><ul><li>사용할 JmsOperations (일반적으로 JmsTemplate)를 설정합니다. JmsOperations는 JMS 메시지를 송수신하는 데 사용되는 인터페이스입니다. JmsItemReader는 이 JmsOperations를 사용하여 메시지를 읽어옵니다.</li></ul></li><li><p><code>itemType(Class&lt;? extends T&gt; itemType)</code></p><ul><li>읽어올 JMS 메시지를 매핑할 도메인 객체의 클래스를 설정합니다. itemType으로 지정된 클래스에 대한 매핑이 수행됩니다.</li></ul></li><li><p><code>build()</code></p><ul><li>설정된 값들을 기반으로 JmsItemReader를 생성합니다.</li></ul></li></ul><h2 id="JdbcPagingItemReader"><a href="#JdbcPagingItemReader" class="headerlink" title="JdbcPagingItemReader"></a>JdbcPagingItemReader</h2><blockquote><p>JdbcPagingItemReaderBuilder 에 의해 생성되는 ItemReader의 구현체</p></blockquote><p>JdbcPagingItemReader는 JDBC를 사용하여 페이징 방식으로 데이터를 읽어오는 Spring Batch의 리더입니다. 주로 관계형 데이터베이스에서 대량의 데이터를 페이징 처리하여 처리할 때 사용됩니다.</p><p>JdbcPagingItemReader는 페이지마다 일괄 처리될 아이템 수를 지정하여 데이터를 효율적으로 처리할 수 있습니다. 각 페이지에서는 지정된 수의 아이템을 데이터베이스로부터 조회하여 처리하며, 페이지마다 커서를 이동시키면서 데이터를 읽어옵니다.</p><p>JdbcPagingItemReader는 다음과 같은 핵심 구성 요소를 가지고 있습니다:</p><ol><li>DataSource: 데이터베이스 연결 정보를 제공하는 객체로, JdbcPagingItemReader가 데이터베이스에 접근할 때 사용됩니다.</li><li>PagingQueryProvider: 페이지별로 실행할 SQL 쿼리를 동적으로 생성하는 역할을 합니다. 데이터베이스의 유형에 따라 적절한 QueryProvider를 선택하여 사용할 수 있습니다.</li><li>RowMapper: JdbcPagingItemReader가 조회한 각 행을 도메인 객체로 매핑하는 역할을 합니다. RowMapper는 Spring의 RowMapper 인터페이스를 구현하여 작성하며, 매핑 로직을 정의합니다.</li></ol><p>JdbcPagingItemReader를 구성할 때는 다음과 같은 단계를 따릅니다:</p><ol><li>DataSource 설정: JdbcPagingItemReader의 데이터베이스 연결 정보를 설정합니다. Spring의 DataSource 인터페이스를 구현한 객체를 제공해야 합니다.</li><li>PagingQueryProvider 설정: 데이터베이스 유형에 따라 적절한 PagingQueryProvider를 선택하고 설정합니다. 이 QueryProvider는 페이지별로 실행될 SQL 쿼리를 동적으로 생성합니다. 대표적으로 JdbcPagingItemReader에서는 SqlPagingQueryProviderFactoryBean을 사용하여 QueryProvider를 설정합니다.</li><li>RowMapper 설정: 조회한 각 행을 매핑할 RowMapper를 구현하고 설정합니다. 각 행을 도메인 객체로 변환하는 매핑 로직을 정의합니다.</li><li>기타 설정: fetchSize, pageSize, parameterValues 등 JdbcPagingItemReader의 동작에 영향을 주는 추가 설정을 수행합니다.</li><li>JdbcPagingItemReader 생성: 위에서 구성한 값들을 사용하여 JdbcPagingItemReader 객체를 생성합니다.</li></ol><p>JdbcPagingItemReader는 Spring Batch의 스텝 구성에서 리더로 사용되며, 청크 단위로 데이터를 읽어옵니다. 각 청크에서는 JdbcPagingItemReader가 페이지별로 지정된 수의 아이템을 데이터베이스에서 조회하여 처리합니다.</p><h4 id="JdbcPagingItemReaderBuilder"><a href="#JdbcPagingItemReaderBuilder" class="headerlink" title="JdbcPagingItemReaderBuilder"></a>JdbcPagingItemReaderBuilder</h4><ul><li><p><code>saveState(boolean saveState)</code></p><ul><li>JdbcPagingItemReader의 상태를 저장할지 여부를 설정합니다. true로 설정하면 상태가 저장되어 재시작 시 이전 상태로 복구됩니다.</li></ul></li><li><p><code>name(String name)</code></p><ul><li>JdbcPagingItemReader의 이름을 설정합니다. 이 이름은 스텝 구성에서 사용될 수 있습니다.</li></ul></li><li><p><code>maxItemCount(int maxItemCount)</code></p><ul><li>최대 읽기 아이템 수를 설정합니다. 이 값을 설정하면 지정된 수만큼 아이템을 읽은 후 리더가 끝납니다.</li></ul></li><li><p><code>currentItemCount(int currentItemCount)</code></p><ul><li>현재 읽은 아이템 수를 설정합니다. 이 값을 설정하면 리더가 재시작될 때 이전 상태로 복구됩니다.</li></ul></li><li><p><code>dataSource(DataSource dataSource)</code></p><ul><li>사용할 DataSource를 설정합니다. JdbcPagingItemReader는 데이터베이스 연결을 수행할 때 이 DataSource를 사용합니다.</li></ul></li><li><p><code>fetchSize(int fetchSize)</code></p><ul><li>데이터베이스로부터 한 번에 가져올 행의 수를 설정합니다.</li></ul></li><li><p><code>rowMapper(RowMapper&lt;T&gt; rowMapper)</code></p><ul><li>각 행을 도메인 객체로 매핑하는 RowMapper를 설정합니다.</li></ul></li><li><p><code>beanRowMapper(Class&lt;T&gt; mappedClass)</code></p><ul><li>도메인 객체의 클래스를 기반으로 BeanPropertyRowMapper를 생성하여 RowMapper로 설정합니다.</li></ul></li><li><p><code>parameterValues(Map&lt;String, Object&gt; parameterValues)</code></p><ul><li>SQL 쿼리의 매개변수 값을 설정합니다. 매개변수 이름과 값을 매핑하는 맵을 전달합니다.</li></ul></li><li><p><code>pageSize(int pageSize)</code></p><ul><li>한 페이지에서 읽을 아이템 수를 설정합니다. 페이지마다 일괄 처리될 아이템 수를 제어하는 데 사용됩니다.</li></ul></li><li><p><code>groupClause(String groupClause)</code></p><ul><li>SQL 쿼리의 GROUP BY 절을 설정합니다.</li></ul></li><li><p><code>selectClause(String selectClause)</code></p><ul><li>SQL 쿼리의 SELECT 절을 설정합니다.</li></ul></li><li><p><code>fromClause(String fromClause)</code></p><ul><li>SQL 쿼리의 FROM 절을 설정합니다.</li></ul></li><li><p><code>whereClause(String whereClause)</code></p><ul><li>SQL 쿼리의 WHERE 절을 설정합니다.</li></ul></li><li><p><code>sortKeys(Map&lt;String, Order&gt; sortKeys)</code></p><ul><li>SQL 쿼리의 정렬 키를 설정합니다. 맵으로 정렬 키와 정렬 방식(Order)을 지정합니다.</li></ul></li><li><p><code>queryProvider(PagingQueryProvider provider)</code></p><ul><li>PagingQueryProvider를 설정하여 SQL 쿼리를 제공합니다. JdbcPagingItemReader는 페이징 쿼리를 동적으로 생성하기 위해 이 QueryProvider를 사용합니다.</li></ul></li><li><p><code>build()</code></p><ul><li>설정된 값들을 기반으로 JdbcPagingItemReader를 생성합니다.</li></ul></li><li><p><code>private PagingQueryProvider determineQueryProvider(DataSource dataSource)</code></p><ul><li>DataSource를 기반으로 PagingQueryProvider를 결정합니다. 데이터베이스 유형에 따라 적합한 QueryProvider를 선택하여 반환합니다.</li></ul></li></ul>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/">Step</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/Chunk/">Chunk</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Spring Batch - ChunkProvider 와 ChunkProcessor</title>
      <link>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/</link>
      <guid>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/</guid>
      <pubDate>Tue, 09 May 2023 03:25:35 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/spring-batch/spring-batch.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;출처&quot;&gt;&lt;a href=&quot;#출처&quot; class=&quot;headerlink&quot; title=&quot;출처&quot;&gt;&lt;/a&gt;출처&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;해당 포스트는</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/spring-batch/spring-batch.jpg"></p><h2 id="출처"><a href="#출처" class="headerlink" title="출처"></a>출처</h2><ul><li>해당 포스트는 정수원 강사님의 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98/dashboard">스프링 배치 - Spring Boot 기반으로 개발하는 Spring Batch</a> 강의를 바탕으로 작성 됐습니다.</li></ul><h2 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h2><ul><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemWriter/" title="Spring Batch - ItemWriter">Spring Batch - ItemWriter</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemProcessor/" title="Spring Batch - ItemProcessor">Spring Batch - ItemProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ItemReader/" title="Spring Batch - ItemReader">Spring Batch - ItemReader</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/" title="Spring Batch - ChunkProvider 와 ChunkProcessor">Spring Batch - ChunkProvider 와 ChunkProcessor</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkOrientedTasklet/" title="Spring Batch - ChunkOrientedTasklet">Spring Batch - ChunkOrientedTasklet</a></li><li><a href="/2023/05/09/springboot/spring-batch/chunk/spring-batch-Chunk/" title="Spring Batch - Chunk 기반 Step">Spring Batch - Chunk 기반 Step</a></li><li><a href="/2023/05/08/springboot/spring-batch/flow/spring-batch-24-FlowJob/" title="Spring Batch - 24. FlowJob">Spring Batch - 24. FlowJob</a></li><li><a href="#">Post not found: springboot/spring-batch/tasklet/spring-batch-23-JobStep</a></li><li><a href="/2023/05/06/springboot/spring-batch/tasklet/spring-batch-22-Tasklet/" title="Spring Batch - 22. Tasklet 기반 Step">Spring Batch - 22. Tasklet 기반 Step</a></li><li><a href="/2023/05/04/springboot/spring-batch/tasklet/spring-batch-21-TaskletStep/" title="Spring Batch - 21. TaskletStep">Spring Batch - 21. TaskletStep</a></li><li><a href="/2023/05/04/springboot/spring-batch/step/spring-batch-20-StepBuilderFactory/" title="Spring Batch - 20. StepBuilderFactory 와 StepBuilder">Spring Batch - 20. StepBuilderFactory 와 StepBuilder</a></li><li><a href="/2023/05/03/springboot/spring-batch/job/spring-batch-19-JobIncrementer/" title="Spring Batch - 19. JobParameters 증가 JobParametersIncrementer">Spring Batch - 19. JobParameters 증가 JobParametersIncrementer</a></li><li><a href="/2023/04/06/springboot/spring-batch/job/spring-batch-18-preventRestart/" title="Spring Batch - 18. Job 의 재시작 방지 preventRestart">Spring Batch - 18. Job 의 재시작 방지 preventRestart</a></li><li><a href="/2023/04/05/springboot/spring-batch/job/spring-batch-17-JobParametersValidator/" title="Spring Batch - 17. JobParameters 검증 JobParametersValidator">Spring Batch - 17. JobParameters 검증 JobParametersValidator</a></li><li><a href="/2023/04/04/springboot/spring-batch/job/spring-batch-16-SimpleJob/" title="Spring Batch - 16. SimpleJob 와 SimpleJobLauncher">Spring Batch - 16. SimpleJob 와 SimpleJobLauncher</a></li><li><a href="/2023/04/02/springboot/spring-batch/job/spring-batch-15-JobBuilderFactory/" title="Spring Batch - 15. JobBuilderFactory &amp; JobBuilder">Spring Batch - 15. JobBuilderFactory &amp; JobBuilder</a></li></ul><h2 id="ChunkProvider"><a href="#ChunkProvider" class="headerlink" title="ChunkProvider"></a>ChunkProvider</h2><p>ChunkProvider는 ItemReader에서 읽어온 데이터를 Chunk 단위로 분할하여 ItemProcessor 및 ItemWriter에 전달하는 객체</p><p>ChunkProvider는 스텝을 실행할 때 Chunk&lt;I&gt; 객체를 만들고 Chunk의 크기를 지정합니다. 예를 들어, Chunk의 크기를 10으로 설정하면, ItemReader에서 10개의 데이터를 읽어와서 ItemProcessor 와 ItemWriter에 전달합니다. 이러한 과정을 Chunk 단위로 반복하여 모든 데이터를 처리합니다.</p><p>ChunkProvider는 ItemReader에서 반환된 모든 데이터를 저장하지 않고, Chunk 단위로 처리하기 때문에 대용량 데이터를 처리하는 데 매우 효율적입니다. 이를 통해 메모리 사용량을 최소화하고, 처리 속도를 향상시킬 수 있습니다.</p><p>Spring Batch에서는 기본적으로 SimpleChunkProvider를 제공합니다. SimpleChunkProvider는 Chunk의 크기를 지정하고, ItemReader에서 읽어온 데이터를 Chunk 단위로 분할하여 ItemProcessor 및 ItemWriter에 전달합니다. 또한, SimpleChunkProvider는 실패 시 롤백을 수행할 수 있도록 구성할 수 있습니다.</p><p>ChunkProvider는 Chunk 기반 스텝의 핵심 역할을 수행하므로, ChunkProvider의 구현 방식은 대용량 데이터 처리 성능에 큰 영향을 미칩니다. 최적의 ChunkProvider 구현 방식을 선택하여 대용량 데이터 처리를 효율적으로 수행할 수 있습니다.</p><h2 id="ChunkProvider-인터페이스"><a href="#ChunkProvider-인터페이스" class="headerlink" title="ChunkProvider 인터페이스"></a>ChunkProvider 인터페이스</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ChunkProvider</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    Chunk&lt;T&gt; <span class="title function_">provide</span><span class="params">(StepContribution contribution)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">postProcess</span><span class="params">(StepContribution contribution, Chunk&lt;T&gt; chunk)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="SimpleChunkProvider"><a href="#SimpleChunkProvider" class="headerlink" title="SimpleChunkProvider"></a>SimpleChunkProvider</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Chunk&lt;I&gt; <span class="title function_">provide</span><span class="params">(<span class="keyword">final</span> StepContribution contribution)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Chunk 객체를 생성한다.</span></span><br><span class="line">    <span class="keyword">final</span> Chunk&lt;I&gt; inputs = <span class="keyword">new</span> <span class="title class_">Chunk</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// Chunk Size 만큼 repeatOperations 를 이용해 read() 를 호출한다.</span></span><br><span class="line">    repeatOperations.iterate(<span class="keyword">new</span> <span class="title class_">RepeatCallback</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> RepeatStatus <span class="title function_">doInIteration</span><span class="params">(<span class="keyword">final</span> RepeatContext context)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="type">I</span> <span class="variable">item</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            Timer.<span class="type">Sample</span> <span class="variable">sample</span> <span class="operator">=</span> Timer.start(Metrics.globalRegistry);</span><br><span class="line">            <span class="type">String</span> <span class="variable">status</span> <span class="operator">=</span> BatchMetrics.STATUS_SUCCESS;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// ItemReader 를 이용해 Item 을 하나씩 읽는다.</span></span><br><span class="line">                item = read(contribution, inputs);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (SkipOverflowException e) &#123;</span><br><span class="line">                <span class="comment">// read() tells us about an excess of skips by throwing an</span></span><br><span class="line">                <span class="comment">// exception</span></span><br><span class="line">                status = BatchMetrics.STATUS_FAILURE;</span><br><span class="line">                <span class="keyword">return</span> RepeatStatus.FINISHED;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span> &#123;</span><br><span class="line">                stopTimer(sample, contribution.getStepExecution(), status);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 더 이상 읽을 Item 이 없을 경우 반복문 종료 및 전체 Chunk 프로세스 종료</span></span><br><span class="line">            <span class="keyword">if</span> (item == <span class="literal">null</span>) &#123;</span><br><span class="line">                inputs.setEnd();</span><br><span class="line">                <span class="keyword">return</span> RepeatStatus.FINISHED;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Chunk 에 ItemReader 로부터 읽은 Item 을 Chunk Size 만큼 저장한다</span></span><br><span class="line">            inputs.add(item);</span><br><span class="line">            contribution.incrementReadCount();</span><br><span class="line">            <span class="keyword">return</span> RepeatStatus.CONTINUABLE;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inputs;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ChunkProcessor"><a href="#ChunkProcessor" class="headerlink" title="ChunkProcessor"></a>ChunkProcessor</h2><p>ChunkProcessor 는 Chunk 단위로 ItemProcessor 를 사용해 Item 을 변형, 가공, 필터링하고 ItemWriter 를 사용해 Chunk 데이터를 저장 및 출력한 후 스텝의 실행 결과를 반환하는 역할을 수행합니다. </p><p>Chunk&lt;O&gt; 객체를 만들고 ChunkProvider 로부터 전달 받은 Chunk&lt;I&gt; 의 Item 을 한 건씩 처리한 후에 Chunk&lt;O&gt; 에 저장합니다.</p><p>ChunkProcessor 는 ChunkProvider 에서 전달받은 Chunk 를 이용하여 ItemProcessor 와 ItemWriter 를 실행하고, 스텝의 실행 결과를 반환하는 역할을 수행합니다. ChunkProcessor 는 각 Chunk에서 ItemProcessor 를 이용하여 데이터를 처리하고, 처리 결과를 ItemWriter 를 통해 출력합니다. 처리 결과는 Chunk 단위로 모아서 스텝의 실행 결과를 결정합니다.</p><p>Spring Batch에서는 기본적으로 SimpleChunkProcessor 를 제공합니다. SimpleChunkProcessor 는 ChunkProvider 에서 Chunk 단위로 전달받은 데이터를 ItemProcessor 및 ItemWriter 에 전달하여 처리하고, 스텝의 실행 결과를 반환합니다. 또한, SimpleChunkProcessor 는 실패 시 롤백을 수행할 수 있도록 구성할 수 있습니다.</p><p>ItemWriter 처리가 완료되면 Chunk 트랜잭션이 종료되고 Step 반복문에서 ChunkOrientedTasklet 이 새롭게 실행됩니다. ItemWriter 는 Chunk 사이즈만큼 데이터를 Commit 하기 때문에 Chunk 사이즈는 곧 Commit Interval 이 됩니다.</p><p>ChunkProcessor는 대용량 데이터 처리 성능에 큰 영향을 미치므로, 최적의 ChunkProcessor 구현 방식을 선택하여 대용량 데이터 처리를 효율적으로 수행할 수 있습니다.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ChunkProcessor</span>&lt;I&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(StepContribution contribution, Chunk&lt;I&gt; chunk)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="SimpleChunkProcessor"><a href="#SimpleChunkProcessor" class="headerlink" title="SimpleChunkProcessor"></a>SimpleChunkProcessor</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(StepContribution contribution, Chunk&lt;I&gt; inputs)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allow temporary state to be stored in the user data field</span></span><br><span class="line">    initializeUserData(inputs);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If there is no input we don&#x27;t have to do anything more</span></span><br><span class="line">    <span class="keyword">if</span> (isComplete(inputs)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ItemProcessor 객체를 이용해 Item 을 처리한 후 Chunk&lt;O&gt; 로 반환한다.</span></span><br><span class="line">    Chunk&lt;O&gt; outputs = transform(contribution, inputs);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ItemProcessor 객체를 이용해 Item 을 Filtering 된 Item 들을 저장한다. </span></span><br><span class="line">    contribution.incrementFilterCount(getFilterCount(inputs, outputs));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ItemWriter 객체를 이용해 Item 들을 저잫아거나 출력한다.</span></span><br><span class="line">    write(contribution, inputs, getAdjustedOutputs(inputs, outputs));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/">Spring Boot</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/">Spring Batch</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/">Step</category>
      
      <category domain="https://ckck803.github.io/categories/Spring-Boot/Spring-Batch/Step/Chunk/">Chunk</category>
      
      
      
      <comments>https://ckck803.github.io/2023/05/09/springboot/spring-batch/chunk/spring-batch-ChunkProvider_ChunkProcessor/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
